<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>æ ‘çš„ç›´å¾„-é¢˜è§£</title>
      <link href="/posts/1138517949/"/>
      <url>/posts/1138517949/</url>
      
        <content type="html"><![CDATA[<p>éƒ½æ˜¯æ°´é¢˜å•¦ï¼Œä½ ä»¬éƒ½èƒ½ä¸€çœ¼ç§’çš„</p><a id="more"></a><h2 id="BZOJ1999-Noip2007-Coreæ ‘ç½‘çš„æ ¸"><a href="#BZOJ1999-Noip2007-Coreæ ‘ç½‘çš„æ ¸" class="headerlink" title="BZOJ1999 [Noip2007] Coreæ ‘ç½‘çš„æ ¸"></a>BZOJ1999 [Noip2007] Coreæ ‘ç½‘çš„æ ¸</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote><p>ç»™å®šä¸€æ£µå¸¦è¾¹æƒæ— æ ¹æ ‘ï¼Œåœ¨å…¶ç›´å¾„ä¸Šæ±‚å‡ºä¸€æ®µé•¿åº¦ä¸è¶…è¿‡ $s$ çš„è·¯å¾„ $F$ ï¼Œä½¿å¾—ç¦»è·¯å¾„è·ç¦»æœ€è¿œçš„ç‚¹åˆ°è·¯å¾„çš„è·ç¦» $ECC$ æœ€çŸ­ã€‚</p><p>ç‚¹ $v$ åˆ°è·¯å¾„ $F$ è·ç¦» $D(v,ğ¹)$ $=$ $minâ¡$ { $d(v,u)$ } , $u$ ä¸ºè·¯å¾„ä¸Šçš„ç‚¹</p></blockquote><p>$$<br>n \leq 500000,s &lt; 2^{32} ï¼Œæ‰€æœ‰è¾¹æƒ&lt;500<br>$$</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å¯¹è·ç¦» $ECC$ äº§ç”Ÿè´¡çŒ®çš„ç‚¹æ¥è‡ªä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†</p><ul><li>ç›´å¾„çš„ç«¯ç‚¹</li><li>è·¯å¾„ä¸Šçš„ç‚¹åˆ°éç›´å¾„ä¸Šç‚¹çš„è·ç¦»</li></ul><p>å¯¹äº<strong>ç›´å¾„çš„ç«¯ç‚¹</strong>ï¼Œæˆ‘ä»¬æœ‰ä¸ªç»“è®ºï¼Œç¦»ä¸€ä¸ªç‚¹è·ç¦»æœ€è¿œçš„ç‚¹æ˜¯ç›´å¾„çš„ä¸€ä¸ªç«¯ç‚¹</p><p>å› è€Œæˆ‘ä»¬æ— éœ€è€ƒè™‘ç›´å¾„ä¸Šé™¤ç«¯ç‚¹å¤–çš„å…¶å®ƒç‚¹ï¼Œ</p><p>é‚£ä¹ˆè·¯å¾„ $F$ å°½å¯èƒ½å¤§ï¼Œæ‰èƒ½ä¿è¯è¿™éƒ¨åˆ†è´¡çŒ®å°½å¯èƒ½å°</p><p>ä½†è¿™åªæ˜¯ä¸€ä¸ªéƒ¨åˆ†ï¼Œæˆ‘ä»¬è¿˜è¦è€ƒè™‘<strong>è·¯å¾„ä¸Šçš„ç‚¹åˆ°éç›´å¾„ä¸Šç‚¹çš„è·ç¦»</strong>çš„è´¡çŒ®</p><p>è¿™éƒ¨åˆ†è´¡çŒ®å¯èƒ½ä¼šæ›´å¤§ï¼Œä½¿å®é™…ä¸Šçš„è·ç¦» $ECC$ æ¯”<strong>ç›´å¾„çš„ç«¯ç‚¹</strong>å½±å“é€ æˆçš„ $ECC$ å¤§ï¼Œ</p><p>ä»¥è‡³äºæ©ç›–ä½<strong>ç›´å¾„çš„ç«¯ç‚¹</strong>çš„è´¡çŒ®ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å– $max$ ä¿è¯ç¬¦åˆå®šä¹‰</p><p>æ±‚è¿™éƒ¨åˆ†è´¡çŒ®å¯ä»¥å¯¹è·¯å¾„ä¸Šæ¯ä¸ªç‚¹ $dfs$ è§£å†³</p><p>å› ä¸º<strong>åœ¨ç›´å¾„ä¸Šä¸”åœ¨è·¯å¾„å¤–çš„ç‚¹</strong>åˆ°<strong>éç›´å¾„ç‚¹çš„è·ç¦»</strong>ä¸€å®šå°äºç­‰äº<strong>ç›´å¾„çš„ç«¯ç‚¹</strong>çš„è´¡çŒ®</p><p>æ²¡æœ‰å½±å“ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯¹æ•´ä¸ªç›´å¾„ä¸Šçš„çš„ç‚¹ $dfs$ï¼Œ</p><h3 id="code"><a href="#code" class="headerlink" title="$code$"></a>$code$</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(a,b) ((a)&lt;(b))?(a):(b)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(a,b) ((a)&gt;(b))?(a):(b)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x7fffffff</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;<span class="keyword">char</span> ch;<span class="keyword">int</span> f=<span class="number">1</span>;ch=getchar();</span><br><span class="line">    <span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(ch);) &#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>) f=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">for</span>(;<span class="built_in">isdigit</span>(ch);) x=x*<span class="number">10</span>+(ch^<span class="number">48</span>),ch=getchar();</span><br><span class="line">    x*=f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">500005</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EDGEE</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> nxt,wei,to;</span><br><span class="line">&#125;edge[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> head[N],tot;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edge[++tot].nxt=head[x];</span><br><span class="line">    edge[tot].to=y;</span><br><span class="line">    edge[tot].wei=v;</span><br><span class="line">    head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n,s,maxn,maxp,ls;</span><br><span class="line"><span class="keyword">int</span> dep[N],is_d[N],pre[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    pre[x]=fa;</span><br><span class="line">    <span class="keyword">if</span>(dep[x]&gt;maxn)</span><br><span class="line">    &#123;</span><br><span class="line">        maxp=x;</span><br><span class="line">        maxn=dep[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=edge[i].nxt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tt=edge[i].to;</span><br><span class="line">        <span class="keyword">if</span>(tt==fa||is_d[tt]) <span class="keyword">continue</span>;</span><br><span class="line">        dep[tt]=dep[x]+edge[i].wei;</span><br><span class="line">        dfs(tt,x);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> x,y,w,ans=INF;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    read(n);read(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        read(x);read(y);read(w);</span><br><span class="line">        add(x,y,w);add(y,x,w);</span><br><span class="line">    &#125;</span><br><span class="line">    maxn=-INF;</span><br><span class="line">    dep[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    dfs(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    ls=maxp;</span><br><span class="line">    maxn=-INF;</span><br><span class="line">    dep[ls]=<span class="number">0</span>;</span><br><span class="line">    dfs(ls,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=maxp,j=maxp;i;i=pre[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(dep[j]-dep[i]&gt;s) j=pre[j];</span><br><span class="line">        ans=min(ans,max(dep[i],maxn-dep[j]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=maxp;i;i=pre[i])</span><br><span class="line">        is_d[i]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=maxp;i;i=pre[i])</span><br><span class="line">    &#123;</span><br><span class="line">        dep[i]=<span class="number">0</span>;</span><br><span class="line">        dfs(i,pre[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        ans=max(ans,dep[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="UVA11695-Flight-Planning"><a href="#UVA11695-Flight-Planning" class="headerlink" title="UVA11695  Flight  Planning"></a>UVA11695  Flight  Planning</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote><p>ç»™ä¸€ä¸ª $N$ ä¸ªèŠ‚ç‚¹è¾¹æƒä¸º 1 çš„æ— æ ¹æ ‘ï¼Œå»æ‰ä¸€æ¡è¾¹ï¼Œæ–°å¢ä¸€æ¡è¾¹ï¼Œæ±‚æ–°çš„æ ‘çš„æœ€é•¿é“¾ï¼Œé—®æ€ä¹ˆå»è¾¹å’ŒåŠ è¾¹ï¼Œä½¿å¾—æœ€é•¿é“¾çš„é•¿åº¦æœ€å°</p></blockquote><p>$$<br>1 \leq n \leq 2500<br>$$</p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>æˆ‘ä»¬å¯ä»¥æšä¸¾æ¯ä¸€æ¡è¦åˆ å»çš„è¾¹</p><p>å»æ‰è¿™æ¡è¾¹åï¼Œæœ€å°çš„æ ‘çš„ç›´å¾„ä¼šå‡ºç°åœ¨ä»¥ä¸‹å‡ ç§æƒ…å†µä¸­</p><ul><li>å­æ ‘ $A$ çš„ç›´å¾„</li><li>å­æ ‘ $B$ çš„ç›´å¾„</li><li>åŠ è¾¹åæ ‘çš„ç›´å¾„</li></ul><p>å­æ ‘ $A$ ï¼Œ$B$ çš„ç›´å¾„æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¿è¯åŠ è¾¹åæ ‘çš„ç›´å¾„æœ€å°</p><p>æ‰€ä»¥è¦åœ¨å­æ ‘ä¸­æ‰¾åˆ°ä¸€ä¸ªç‚¹ä½¿å…¶åˆ°è¯¥å­æ ‘å…¶ä»–ç‚¹çš„æœ€å¤§è·ç¦»æœ€å°</p><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ªç‚¹ä¸€å®šæ˜¯ç›´å¾„çš„ä¸­ç‚¹ï¼Œ</p><p>å­æ ‘çš„è¿™ä¸¤ä¸ªç‚¹å°±æ˜¯è¦è¿è¾¹çš„èŠ‚ç‚¹</p><h3 id="code-1"><a href="#code-1" class="headerlink" title="$code$"></a>$code$</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x7fffffff</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;<span class="keyword">char</span> ch;<span class="keyword">int</span> f=<span class="number">1</span>;ch=getchar();</span><br><span class="line">    <span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(ch);) &#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>) f=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">for</span>(;<span class="built_in">isdigit</span>(ch);) x=x*<span class="number">10</span>+(ch^<span class="number">48</span>),ch=getchar();</span><br><span class="line">    x*=f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5005</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EDGEE</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> nxt,from,to;</span><br><span class="line">&#125;edge[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> head[N],tot;</span><br><span class="line"><span class="keyword">int</span> T,n,x,y,addA,addB,p_addA,p_addB,lenA,lenB,delA,delB,ans=INF;</span><br><span class="line"><span class="keyword">int</span> dep[N],pre[N],maxp,maxn=-INF,minn=INF,rbq,ls;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edge[++tot].nxt=head[x];</span><br><span class="line">    edge[tot].from=x;</span><br><span class="line">    edge[tot].to=y;</span><br><span class="line">    head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa,<span class="keyword">const</span> <span class="keyword">int</span> &amp;del)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    pre[x]=fa;</span><br><span class="line">    <span class="keyword">if</span>(dep[x]&gt;maxn)</span><br><span class="line">    &#123;</span><br><span class="line">        maxp=x;</span><br><span class="line">        maxn=dep[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=edge[i].nxt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i==del||i==(del+<span class="number">1</span>)) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> tt=edge[i].to;</span><br><span class="line">        <span class="keyword">if</span>(tt==fa) <span class="keyword">continue</span>;</span><br><span class="line">        dep[tt]=dep[x]+<span class="number">1</span>;</span><br><span class="line">        dfs(tt,x,del);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> del)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//memset(pre,0,sizeof(pre));</span></span><br><span class="line">    maxp=edge[del].from;</span><br><span class="line">    maxn=-INF;</span><br><span class="line">    minn=INF;</span><br><span class="line">    dep[edge[del].from]=<span class="number">0</span>;</span><br><span class="line">    dfs(edge[del].from,<span class="number">0</span>,del);</span><br><span class="line"></span><br><span class="line"><span class="comment">//memset(pre,0,sizeof(pre));</span></span><br><span class="line">    ls=maxp;</span><br><span class="line">    maxn=-INF;</span><br><span class="line">    minn=INF;</span><br><span class="line">    dep[ls]=<span class="number">0</span>;</span><br><span class="line">    dfs(ls,<span class="number">0</span>,del);</span><br><span class="line"></span><br><span class="line">    lenA=maxn;</span><br><span class="line">    p_addA=maxp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;lenA/<span class="number">2</span>;i++) p_addA=pre[p_addA];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//--------------------------------------------------</span></span><br><span class="line"><span class="comment">//memset(pre,0,sizeof(pre));</span></span><br><span class="line">    maxp=edge[del].to;</span><br><span class="line">    maxn=-INF;</span><br><span class="line">    minn=INF;</span><br><span class="line">    dep[edge[del].to]=<span class="number">0</span>;</span><br><span class="line">    dfs(edge[del].to,<span class="number">0</span>,del);</span><br><span class="line"></span><br><span class="line"><span class="comment">//memset(pre,0,sizeof(pre));</span></span><br><span class="line">    ls=maxp;</span><br><span class="line">    maxn=-INF;</span><br><span class="line">    minn=INF;</span><br><span class="line">    dep[ls]=<span class="number">0</span>;</span><br><span class="line">    dfs(ls,<span class="number">0</span>,del);</span><br><span class="line"></span><br><span class="line">    lenB=maxn;</span><br><span class="line">    p_addB=maxp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;lenB/<span class="number">2</span>;i++) p_addB=pre[p_addB];</span><br><span class="line"></span><br><span class="line">    rbq=max(max(lenA,lenB),(lenA+<span class="number">1</span>)/<span class="number">2</span>+(lenB+<span class="number">1</span>)/<span class="number">2</span>+<span class="number">1</span>);</span><br><span class="line"><span class="comment">//    cout&lt;&lt;"$"&lt;&lt;lenA&lt;&lt;' '&lt;&lt;lenB&lt;&lt;"$"&lt;&lt;endl;</span></span><br><span class="line">    <span class="keyword">if</span>(ans&gt;rbq)</span><br><span class="line">    &#123;</span><br><span class="line">        ans=rbq;</span><br><span class="line">        delA=edge[del].from;</span><br><span class="line">        delB=edge[del].to;</span><br><span class="line">        addA=p_addA;</span><br><span class="line">        addB=p_addB;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    read(T);</span><br><span class="line">    <span class="keyword">for</span>(;T--;)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">        <span class="built_in">memset</span>(edge,<span class="number">0</span>,<span class="keyword">sizeof</span>(edge));</span><br><span class="line">        tot=<span class="number">0</span>;ans=INF;</span><br><span class="line">        read(n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            read(x);read(y);</span><br><span class="line">            add(x,y);add(y,x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=tot;i+=<span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            solve(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,delA,delB);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,addA,addB);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="BZOJ1912-APIO2010-patrol-å·¡é€»"><a href="#BZOJ1912-APIO2010-patrol-å·¡é€»" class="headerlink" title="BZOJ1912  [APIO2010] patrol å·¡é€»"></a>BZOJ1912  [APIO2010] patrol å·¡é€»</h2><h3 id="é¢˜ç›®æè¿°-2"><a href="#é¢˜ç›®æè¿°-2" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p><a href="https://www.luogu.org/problemnew/show/P3629" target="_blank" rel="noopener">é“¾æ¥</a></p><h3 id="é¢˜è§£-2"><a href="#é¢˜è§£-2" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å¾ˆæ˜¾ç„¶ï¼Œå½“ $k = 1$ æ—¶ï¼Œæ‰¾åˆ°ç›´å¾„ç„¶åè¿ç«¯ç‚¹å°±å¯ä»¥äº†</p><p>å½“ $k = 2$ æ—¶ï¼Œæˆ‘ä»¬è¦æ‰¾ç›´å¾„å’Œ<strong>è¾¹ä¸ç›¸äº¤</strong>çš„ç¬¬äºŒå¤§ç›´å¾„</p><p>å½“ä¸¤æ¡ç›´å¾„ç›¸äº¤çš„æ—¶å€™ï¼Œ</p><p>å› ä¸ºåŠ çš„è¾¹å¿…é¡»èµ°ï¼Œæ‰€ä»¥ç¬¬äºŒæ¡åŠ è¾¹å¹¶æ²¡æœ‰èµ·åˆ°ç¼©çŸ­è·¯ç¨‹çš„ä½œç”¨ï¼Œåè€Œå¤šèŠ±è´¹äº† $1$</p><p>åè€Œä¸å¦‚æŠŠè¾¹é€€åŒ–æˆç‚¹ï¼Œé•¿åº¦ä¸º $0$</p><p>æ‰¾æ¬¡å¤§ç›´å¾„å¯ä»¥æŠŠç›´å¾„ä¸Šçš„è¾¹æƒæ”¹æˆ $-1$ ï¼Œå†æ±‚ç›´å¾„</p><p>ç”±äºå‡ºç°äº†è´Ÿè¾¹æƒï¼Œç”¨ dfs/bfs ä¼šæŒ‚ ï¼ˆå¯èƒ½æ˜¯æˆ‘å¤ªèœäº†ï¼‰</p><p>æ‰€ä»¥ç”¨ $dp$ æ±‚è§£</p><h3 id="code-2"><a href="#code-2" class="headerlink" title="$code$"></a>$code$</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x7fffffff</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;<span class="keyword">char</span> ch;<span class="keyword">int</span> f=<span class="number">1</span>;ch=getchar();</span><br><span class="line">    <span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(ch);) &#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>) f=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">for</span>(;<span class="built_in">isdigit</span>(ch);) x=x*<span class="number">10</span>+(ch^<span class="number">48</span>),ch=getchar();</span><br><span class="line">    x*=f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100005</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EDGEE</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> nxt,wei,to;</span><br><span class="line">&#125;edge[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> head[N],tot;</span><br><span class="line"><span class="keyword">int</span> n,k,maxn=-INF,maxp,ls,len1,len2; </span><br><span class="line"><span class="keyword">int</span> dep[N],pre[N],dis[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edge[++tot].nxt=head[x];</span><br><span class="line">    edge[tot].to=y;</span><br><span class="line">    edge[tot].wei=<span class="number">1</span>;</span><br><span class="line">    head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    pre[x]=fa;</span><br><span class="line">    <span class="keyword">if</span>(maxn&lt;dep[x])</span><br><span class="line">    &#123;</span><br><span class="line">        maxn=dep[x];</span><br><span class="line">        maxp=x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=edge[i].nxt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tt=edge[i].to;</span><br><span class="line">        <span class="keyword">if</span>(tt==fa) <span class="keyword">continue</span>;</span><br><span class="line"><span class="comment">//cout&lt;&lt;x&lt;&lt;' '&lt;&lt;tt&lt;&lt;endl;</span></span><br><span class="line">        dep[tt]=dep[x]+edge[i].wei;</span><br><span class="line">        dfs(tt,x);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">maxlen</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=edge[i].nxt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tt=edge[i].to;</span><br><span class="line">        <span class="keyword">if</span>(tt==fa) <span class="keyword">continue</span>;</span><br><span class="line">        maxlen(tt,x);</span><br><span class="line"><span class="comment">//cout&lt;&lt;x&lt;&lt;' '&lt;&lt;tt&lt;&lt;endl;</span></span><br><span class="line">        len2=max(len2,dis[x]+dis[tt]+edge[i].wei);</span><br><span class="line">        dis[x]=max(dis[x],dis[tt]+edge[i].wei);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=edge[i].nxt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tt=edge[i].to;</span><br><span class="line">        <span class="keyword">if</span>(tt==fa||tt!=pre[x]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="comment">//cout&lt;&lt;x&lt;&lt;' '&lt;&lt;tt&lt;&lt;endl;</span></span><br><span class="line">        edge[i].wei=<span class="number">-1</span>;</span><br><span class="line">        edge[i&amp;<span class="number">1</span>?(i+<span class="number">1</span>):(i<span class="number">-1</span>)].wei=<span class="number">-1</span>;</span><br><span class="line">        work(tt,x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> x,y;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    read(n);read(k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        read(x);read(y);</span><br><span class="line">        add(x,y);add(y,x);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    maxn=-INF;</span><br><span class="line">    dep[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    dfs(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    ls=maxp;</span><br><span class="line">    maxn=-INF;</span><br><span class="line">    dep[ls]=<span class="number">0</span>;</span><br><span class="line">    dfs(ls,<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    len1=maxn;</span><br><span class="line">    <span class="keyword">if</span>(k==<span class="number">1</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>,<span class="number">2</span>*(n<span class="number">-1</span>)-len1+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    work(maxp,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    maxlen(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,<span class="number">2</span>*(n<span class="number">-1</span>)-len1-len2+<span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> é¢˜è§£ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ ‘ä¸Šå·®åˆ†-é¢˜è§£</title>
      <link href="/posts/2952530072/"/>
      <url>/posts/2952530072/</url>
      
        <content type="html"><![CDATA[<p>éƒ½æ˜¯æ°´é¢˜å•¦ï¼Œä½ ä»¬éƒ½èƒ½ä¸€çœ¼ç§’çš„</p><a id="more"></a><h2 id="EOJ-Monthly-2018-8-D-Deliveryï¼ˆæ°´é¢˜ï¼‰"><a href="#EOJ-Monthly-2018-8-D-Deliveryï¼ˆæ°´é¢˜ï¼‰" class="headerlink" title="EOJ Monthly 2018.8 D.Deliveryï¼ˆæ°´é¢˜ï¼‰"></a>EOJ Monthly 2018.8 D.Deliveryï¼ˆæ°´é¢˜ï¼‰</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote><p>æœ‰ä¸€æ£µ $N$ ä¸ªèŠ‚ç‚¹çš„æ ‘ ï¼Œæ ‘çš„æ¯æ¡è¾¹éƒ½æœ‰å„è‡ªçš„æƒå€¼ $W_i$ ï¼Œåœ¨è¯¢é—®å¼€å§‹å‰ï¼Œå¯ä»¥äº¤æ¢ä»»ä¸€ä¸¤æ¡è¾¹çš„æƒå€¼ï¼Œæ¬¡æ•°ä¸é™ï¼Œæœ‰ $q$ ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®åŒ…å«ä¸€ä¸ªèµ·ç‚¹ $S_i$ å’Œç»ˆç‚¹ $T_i$ ï¼Œä»èµ·ç‚¹åˆ°ç»ˆç‚¹ç»è¿‡çš„è¾¹çš„æƒå€¼å’Œå°±æ˜¯è¿™æ¬¡è¯¢é—®çš„èŠ±è´¹ï¼Œæ±‚æ‰€æœ‰è¯¢é—®çš„æœ€å°èŠ±è´¹å’Œ</p></blockquote><p>$$<br>1 \leq n \leq 2 \times 10^5,1 \leq q \leq 2 \times 10^5<br>$$<br>$$<br>1 \leq u_i,v_i \leq n,u_i \neq v_i<br>$$<br>$$<br>1 \leq w_i \leq 1000<br>$$<br>$$<br>1 \leq s_i,t_i \leq n,s_i \neq t_i<br>$$</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>è¿™å°±æ˜¯æ±‚è¾¹è¦†ç›–æ¬¡æ•°çš„è£¸é¢˜å•Šï¼Œè¦†ç›–è¾¹æŒ‰è¦†ç›–æ¬¡æ•°ç»™äºˆä»å°åˆ°å¤§çš„æƒå€¼å°±ç»“æŸå•¦</p><p>å¤ªæ°´ä¸è´´ä»£ç </p><hr><h2 id="BZOJ4424-CF19E-Fairyï¼ˆå¤§æ°´é¢˜ï¼‰"><a href="#BZOJ4424-CF19E-Fairyï¼ˆå¤§æ°´é¢˜ï¼‰" class="headerlink" title="BZOJ4424/CF19E    Fairyï¼ˆå¤§æ°´é¢˜ï¼‰"></a>BZOJ4424/CF19E    Fairyï¼ˆå¤§æ°´é¢˜ï¼‰</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote><p>   ç»™å®š $N$ ä¸ªç‚¹ï¼Œ$M$ æ¡è¾¹çš„æ— å‘å›¾ï¼Œå¯ä»¥ä»å›¾ä¸­åˆ é™¤ä¸€æ¡è¾¹ï¼Œé—®åˆ é™¤å“ªäº›è¾¹å¯ä»¥ä½¿å›¾å˜æˆä¸€ä¸ªäºŒåˆ†å›¾ã€‚</p></blockquote><p>$$<br>1 \leq n,m \leq 1000000<br>$$</p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>é¦–å…ˆäºŒåˆ†å›¾æ˜¯æ²¡æœ‰å¥‡ç¯çš„ï¼Œæˆ‘ä»¬è¦åˆ è¾¹æ¥å»æ‰å¥‡ç¯</p><p>åªæœ‰ä¸€æ¡è¾¹è¢«æ‰€æœ‰çš„å¥‡ç¯è¦†ç›–æ—¶æ‰èƒ½å»åˆ å®ƒï¼Œè¿™æ ·æ‰èƒ½ä¿è¯æ²¡æœ‰å¥‡ç¯</p><p>å¦‚æœè¿™æ¡è¾¹è¢«å¶ç¯è¦†ç›–çš„è¯ï¼Œæ— è®ºæ€ä¹ˆåˆ éƒ½ä¼šå‡ºç°ä¸€ä¸ªæ–°å¥‡ç¯ï¼Œè¿™æ¡è¾¹æ˜¯ä¸èƒ½åˆ çš„</p><p>æˆ‘ä»¬å¯¹å›¾ $dfs$ éå†ï¼Œå¯¹è¾¹æ–°å»ºå‡ºä¸€æ£µæ ‘</p><p>ç„¶åè¿™ä¸ªè¾¹çš„è¦†ç›–é—®é¢˜å°±å¯ä»¥é€šè¿‡æ ‘ä¸Šå·®åˆ†è§£å†³</p><h3 id="code"><a href="#code" class="headerlink" title="$code$"></a>$code$</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">data</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> nxt,to,id;</span><br><span class="line">&#125;edge[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EDGEE</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> nxt,to;</span><br><span class="line">&#125;edge2[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> n,m,tot=<span class="number">0</span>,tot2=<span class="number">0</span>,top=<span class="number">0</span>,cnt=<span class="number">0</span>,cnt2=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],head2[N],sta[N&lt;&lt;<span class="number">1</span>],pos[N&lt;&lt;<span class="number">1</span>],vis[N&lt;&lt;<span class="number">1</span>],vis2[N&lt;&lt;<span class="number">1</span>],sum[N&lt;&lt;<span class="number">1</span>],fir[N&lt;&lt;<span class="number">1</span>],ans[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edge[++tot].nxt=head[x];</span><br><span class="line">    edge[tot].to=y;</span><br><span class="line">    edge[tot].id=i;</span><br><span class="line">    head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edge2[++tot2].nxt=head2[x];</span><br><span class="line">    edge2[tot2].to=y;</span><br><span class="line">    head2[x]=tot2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> fa,<span class="keyword">int</span> pre_id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    sta[++top]=now;pos[now]=top;vis[now]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[now];i;i=edge[i].nxt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tt=edge[i].to,nid=edge[i].id;</span><br><span class="line">        <span class="keyword">if</span>(nid==pre_id) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span>(!vis2[nid]) vis2[nid]=<span class="number">1</span>,add2(pre_id,nid),add2(nid,pre_id);</span><br><span class="line">        <span class="keyword">if</span>(!pos[tt]) fir[tt]=nid,dfs(tt,now,nid);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(vis[tt])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>((pos[now]-pos[tt]+<span class="number">1</span>)&amp;<span class="number">1</span>) sum[nid]++,sum[fir[tt]]--,cnt++;</span><br><span class="line">            <span class="keyword">else</span> sum[nid]--,sum[fir[tt]]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    vis[now]=<span class="number">0</span>;top--;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head2[now];i;i=edge2[i].nxt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tt=edge2[i].to;</span><br><span class="line">        <span class="keyword">if</span>(tt==fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs2(tt,now);</span><br><span class="line">        sum[now]+=sum[tt];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(sum[now]==cnt) ans[++cnt2]=now;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> x,y;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">ifdef</span> ROY1994</span></span><br><span class="line">        freopen(<span class="string">"testdata.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">        freopen(<span class="string">"A.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    io&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        io&gt;&gt;x&gt;&gt;y;</span><br><span class="line">        add(x,y,i);</span><br><span class="line">        add(y,x,i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="keyword">if</span>(!pos[i]) dfs(i,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    dfs2(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(!cnt)</span><br><span class="line">    &#123;</span><br><span class="line">        io&lt;&lt;m&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">            io&lt;&lt;i&lt;&lt;<span class="string">' '</span>;</span><br><span class="line">        io&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(ans+<span class="number">1</span>,ans+cnt2+<span class="number">1</span>);</span><br><span class="line">    io&lt;&lt;cnt2&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=cnt2;i++)</span><br><span class="line">        io&lt;&lt;ans[i]&lt;&lt;<span class="string">' '</span>;</span><br><span class="line">    io&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="2017-SEERC-L-Divide-and-Conquerï¼ˆå·¨æ°´é¢˜ï¼‰"><a href="#2017-SEERC-L-Divide-and-Conquerï¼ˆå·¨æ°´é¢˜ï¼‰" class="headerlink" title="2017 SEERC  L.  Divide and Conquerï¼ˆå·¨æ°´é¢˜ï¼‰"></a>2017 SEERC  L.  Divide and Conquerï¼ˆå·¨æ°´é¢˜ï¼‰</h2><h3 id="é¢˜ç›®æè¿°-2"><a href="#é¢˜ç›®æè¿°-2" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote><p>æœ‰ä¸€ä¸ªæœ‰ $N$ ä¸ªç‚¹çš„ç”±ä¸¤æ£µä¸åŒçš„æ ‘æ„æˆçš„å¤åˆå›¾(æ— é‡è¾¹)ã€‚</p><p>é—®æœ€å°‘åˆ‡æ–­å‡ æ¡è¾¹ï¼Œå¯ä»¥ä½¿åŸå›¾ä¸è”é€šã€‚å¹¶è¾“å‡ºæ–¹æ¡ˆæ•°</p></blockquote><p>$$<br>1 \leq n \leq 1000000<br>$$</p><h3 id="é¢˜è§£-2"><a href="#é¢˜è§£-2" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>é¦–å…ˆåˆ‡æ–­çš„è¾¹æ•°è‚¯å®šæ˜¯ 2 ~ 3 </p><p>è¿™æ˜¯ä¸¤æ£µæ ‘ç»„æˆçš„å›¾ï¼Œæ‰€ä»¥åªæœ‰ $2N-2$ æ¡è¾¹ï¼Œ</p><p>å‡è®¾åˆ‡æ–­ 4 æ¡è¾¹æ‰èƒ½ä¿è¯ä¸è”é€šï¼Œé‚£ä¹ˆè‡³å°‘è¦æœ‰ $2N$ æ¡è¾¹ï¼Œå¾ˆæ˜¾ç„¶çŸ›ç›¾</p><p>æ‰€ä»¥è‚¯å®šåˆ‡æ–­ 2 ~ 3 æ¡è¾¹</p><p>é‚£ä¹ˆå¿…ç„¶æ˜¯ä¸€é¢—æ ‘ä¸Šåˆ‡æ–­ 1 æ¡è¾¹ï¼Œå¦ä¸€é¢—æ ‘ä¸Šåˆ‡æ–­ 1 ~ 2 æ¡è¾¹</p><p>æˆ‘ä»¬å…ˆä»¥ $A$ æ ‘ä¸ºä¸»ï¼ŒæŠŠ $B$ æ ‘çš„è¾¹ä½œä¸ºè¿”ç¥–è¾¹/æ¨ªæ’è¾¹</p><p>é‚£ä¹ˆå°±ç›¸å½“äºæ±‚æ¨ªè·¨ $A$ æ ‘çš„å±äº $B$ æ ‘çš„è¾¹æ•°ï¼Œ</p><p>è¿™ä¸ªå¯ä»¥é€šè¿‡æ ‘ä¸Šå·®åˆ†è§£å†³</p><p>æ¯ä¸ªèŠ‚ç‚¹çš„ $sum$ å°±æ˜¯æ¨ªè·¨å…¶çš„ $B$ æ ‘è¾¹æ•°</p><p>æˆ‘ä»¬å¯¹ $sum+1$ å–æœ€å°å€¼ $minn$ å¹¶è®°å½•æ–¹æ¡ˆæ•°</p><p>å¦‚æœ $minn=2$ ç›´æ¥è¾“å‡º</p><p>å¦‚æœ $minn=3$ å› ä¸ºå¯ä»¥ $A$ æ ‘æ–­ 2 æ¡ï¼Œ $B$ æ ‘æ–­ 1 æ¡</p><p>æˆ‘ä»¬äº¤æ¢å†ç»Ÿè®¡ä¸€æ¬¡æ–¹æ¡ˆåŠ ä¸Šä¹‹å‰çš„å°±æ˜¯æ–¹æ¡ˆæ•°</p><h3 id="code-1"><a href="#code-1" class="headerlink" title="$code$"></a>$code$</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> s=<span class="number">0</span>,w=<span class="number">1</span>;</span><br><span class="line">   <span class="keyword">char</span> ch=getchar();</span><br><span class="line">   <span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)w=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">   <span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) s=s*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">   <span class="keyword">return</span> s*w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100005</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">data</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> from,to;</span><br><span class="line">&#125;A[N&lt;&lt;<span class="number">1</span>],B[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EDGEE</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> nxt,to;</span><br><span class="line">&#125;edge[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> tot=<span class="number">0</span>,head[N];</span><br><span class="line"><span class="keyword">int</span> f[N][<span class="number">30</span>],dep[N],sum[N],q[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> n,stp,ans,minn=<span class="number">0x7fffffff</span>;</span><br><span class="line"><span class="keyword">int</span> m1,m2;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edge[++tot].nxt=head[x];</span><br><span class="line">    edge[tot].to=y;</span><br><span class="line">    head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> Head=<span class="number">1</span>,tail=<span class="number">0</span>;</span><br><span class="line">    dep[<span class="number">1</span>]=<span class="number">1</span>;f[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    q[++tail]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(Head&lt;=tail)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> now=q[Head++];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=head[now];i;i=edge[i].nxt)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> tt=edge[i].to;</span><br><span class="line">            <span class="keyword">if</span>(dep[tt]) <span class="keyword">continue</span> ;</span><br><span class="line">            dep[tt]=dep[now]+<span class="number">1</span>;</span><br><span class="line">            f[tt][<span class="number">0</span>]=now;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=stp;j++)</span><br><span class="line">                f[tt][j]=f[f[tt][j<span class="number">-1</span>]][j<span class="number">-1</span>];</span><br><span class="line">            q[++tail]=tt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[x]&lt;dep[y]) swap(x,y);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=stp;i&gt;=<span class="number">0</span>;i--) </span><br><span class="line">        <span class="keyword">if</span>(dep[f[x][i]]&gt;=dep[y]) x=f[x][i];</span><br><span class="line">    <span class="keyword">if</span>(x==y) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=stp;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">        <span class="keyword">if</span>(f[x][i]!=f[y][i]) x=f[x][i],y=f[y][i];</span><br><span class="line">    <span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=edge[i].nxt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tt=edge[i].to;</span><br><span class="line">        <span class="keyword">if</span>(tt==f[x][<span class="number">0</span>]) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(tt);</span><br><span class="line">        sum[x]+=sum[tt];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span>(sum[x]+<span class="number">1</span>&lt;minn) minn=sum[x]+<span class="number">1</span>,ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(sum[x]+<span class="number">1</span>==minn) ans++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ADD</span><span class="params">(<span class="keyword">int</span> ff)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(ff==<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">            add(A[i].from,A[i].to),add(A[i].to,A[i].from);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">            add(B[i].from,B[i].to),add(B[i].to,B[i].from);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ClearE</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(edge,<span class="number">0</span>,<span class="keyword">sizeof</span>(edge));</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">memset</span>(sum,<span class="number">0</span>,<span class="keyword">sizeof</span>(sum));</span><br><span class="line">    <span class="built_in">memset</span>(dep,<span class="number">0</span>,<span class="keyword">sizeof</span>(dep));</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">    tot=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> x,y;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//freopen("ME.in","r",stdin);</span></span><br><span class="line"><span class="comment">//freopen("ME.out","w",stdout);</span></span><br><span class="line">    n=read();</span><br><span class="line">    stp=(<span class="keyword">int</span>)log2(n)+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        x=read();y=read();</span><br><span class="line">        A[i].from=x,A[i].to=y;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        x=read();y=read();</span><br><span class="line">        B[i].from=x,B[i].to=y;</span><br><span class="line">    &#125;</span><br><span class="line">    ADD(<span class="number">1</span>);</span><br><span class="line">    bfs();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        sum[B[i].from]++;</span><br><span class="line">        sum[B[i].to]++;</span><br><span class="line">        sum[lca(B[i].from,B[i].to)]-=<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(minn==<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,minn,ans);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ClearE();</span><br><span class="line">    ADD(<span class="number">2</span>);</span><br><span class="line">    bfs();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        sum[A[i].from]++;</span><br><span class="line">        sum[A[i].to]++;</span><br><span class="line">        sum[lca(A[i].from,A[i].to)]-=<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,minn,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> é¢˜è§£ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>bitsetè®²è§£</title>
      <link href="/posts/36423/"/>
      <url>/posts/36423/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸ºäº†å†™ä¸€é“<a href="https://www.luogu.org/problemnew/show/P3674" target="_blank" rel="noopener">æ¯’ç˜¤é¢˜</a>ï¼Œå†³å®šå­¦ä¸€ä¸‹ <strong>bitset</strong></p></blockquote><a id="more"></a><h1 id="å¤´æ–‡ä»¶"><a href="#å¤´æ–‡ä»¶" class="headerlink" title="å¤´æ–‡ä»¶"></a>å¤´æ–‡ä»¶</h1><p> <code>#include&lt;bitset&gt;</code></p><p>  åŒæ—¶éœ€è¦å‘½åç©ºé—´ <code>std</code></p><h1 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bitset</span> &lt;N&gt; bs</span><br><span class="line"><span class="comment">// é»˜è®¤çš„æ„é€ å‡½æ•°å°†å…¶åˆå§‹ä¸ºå…¨0</span></span><br></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹ï¼Œ<strong>bitset</strong> çš„ $bs[0]$ æ˜¯æœ€åä¸€ä½ï¼Œè€Œ $bs[N-1]$ æ˜¯ç¬¬ä¸€ä½</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">bitset</span>&lt;8&gt; bs;</span><br><span class="line"><span class="comment">//bs[0] = 1;            // 0000 0001</span></span><br><span class="line"><span class="comment">//bs[7] = 1;            // 1000 0000</span></span><br></pre></td></tr></table></figure><h1 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">bitset</span>&lt;8&gt; bs(<span class="number">7</span>);</span><br><span class="line">    <span class="comment">// 0000 0111</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">bitset</span>&lt;8&gt; bs(<span class="number">0x07</span>);</span><br><span class="line">    <span class="comment">// 0000 0111</span></span><br><span class="line"><span class="built_in">bitset</span>&lt;numeric_limits&lt;<span class="keyword">unsigned</span> <span class="keyword">short</span>&gt;::digits&gt; bs1(<span class="number">267</span>);</span><br><span class="line">    <span class="comment">// 16ä½ </span></span><br><span class="line"><span class="built_in">bitset</span>&lt;numeric_limits&lt;<span class="keyword">unsigned</span> <span class="keyword">long</span>&gt;::digits&gt; bs2(<span class="number">267</span>);</span><br><span class="line">    <span class="comment">// 32ä½</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">bitset</span>&lt;8&gt; bs(<span class="string">"00000111"</span>);</span><br><span class="line">    <span class="comment">// 7</span></span><br></pre></td></tr></table></figure><h1 id="æ“ä½œ"><a href="#æ“ä½œ" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h1><table><thead><tr><th>æˆå‘˜å‡½æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>bs.any()</code></td><td>æ˜¯å¦å­˜åœ¨å€¼ä¸º 1 çš„äºŒè¿›åˆ¶ä½</td></tr><tr><td><code>bs.none()</code></td><td>æ˜¯å¦ä¸å­˜åœ¨å€¼ä¸º 1 çš„äºŒè¿›åˆ¶ä½  æˆ–è€…è¯´æ˜¯å¦å…¨éƒ¨ä½ä¸º 0</td></tr><tr><td><code>bs.size()</code></td><td>ä½é•¿ï¼Œä¹Ÿå³æ˜¯éæ¨¡æ¿å‚æ•°å€¼</td></tr><tr><td><code>bs.count()</code></td><td>å€¼ä¸º 1 çš„ä¸ªæ•°</td></tr><tr><td><code>bs.test(pos)</code></td><td>æµ‹è¯• pos å¤„çš„äºŒè¿›åˆ¶ä½æ˜¯å¦ä¸º 1         è¿”å›å’Œ0åšæˆ–è¿ç®—çš„å€¼</td></tr><tr><td><code>bs.set()</code></td><td>å…¨éƒ¨ä½ç½®é‡ç½®ä¸º 1</td></tr><tr><td><code>bs.set(pos)</code></td><td>pos ä½çš„äºŒè¿›åˆ¶ä½ç½®ä¸ 1 åšæˆ–è¿ç®—</td></tr><tr><td><code>bs.reset()</code></td><td>å…¨éƒ¨ä½ç½®é‡ç½®ä¸º 0</td></tr><tr><td><code>bs.reset(pos)</code></td><td>pos ä½çš„äºŒè¿›åˆ¶ä½ç½®ä¸ 0 åšæˆ–è¿ç®—</td></tr><tr><td><code>bs.flip()</code></td><td>å…¨éƒ¨ä½é€ä½å–å</td></tr><tr><td><code>bs.flip(pos)</code></td><td>poså¤„çš„äºŒè¿›åˆ¶ä½å–å</td></tr><tr><td><code>bs.to_ulong()</code></td><td>å°†äºŒè¿›åˆ¶è½¬æ¢ä¸ºunsigned longè¾“å‡º</td></tr><tr><td><code>bs.to_string()</code></td><td>å°†äºŒè¿›åˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²è¾“å‡º</td></tr><tr><td><code>~bs</code></td><td>æŒ‰ä½å–å æ•ˆæœç­‰æ•ˆä¸º <code>bs.flip()</code></td></tr><tr><td><code>os &lt;&lt; b</code></td><td>å°†äºŒè¿›åˆ¶ä½è¾“å‡ºåˆ°osæµ å°å€¼åœ¨å³ï¼Œå¤§å€¼åœ¨å·¦</td></tr></tbody></table><h1 id="è¿ç®—"><a href="#è¿ç®—" class="headerlink" title="è¿ç®—"></a>è¿ç®—</h1><p><strong>bitset</strong> çš„è¿ç®—å°±åƒä¸€ä¸ªæ™®é€šçš„æ•´æ•°ä¸€æ ·ï¼Œå¯ä»¥è¿›è¡Œ ä¸ ( <strong>&amp;</strong> ) ã€æˆ– ( <strong>|</strong> ) ã€ å¼‚æˆ– ( <strong>^</strong> )ã€ å·¦ç§» ( <strong>&lt;&lt;</strong> ) ã€ å³ç§» ( <strong>&gt;&gt;</strong> ) ç­‰æ“ä½œã€‚<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bitset</span>&lt;4&gt; foo (<span class="built_in">std</span>::<span class="built_in">string</span>(<span class="string">"1001"</span>));</span><br><span class="line"><span class="built_in">bitset</span>&lt;4&gt; bar (<span class="built_in">std</span>::<span class="built_in">string</span>(<span class="string">"0011"</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (foo^=bar) &lt;&lt; <span class="string">'\n'</span>;       <span class="comment">// 1010 (XOR,assign)</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (foo&amp;=bar) &lt;&lt; <span class="string">'\n'</span>;       <span class="comment">// 0010 (AND,assign)</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (foo|=bar) &lt;&lt; <span class="string">'\n'</span>;       <span class="comment">// 0011 (OR,assign)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (foo&lt;&lt;=<span class="number">2</span>) &lt;&lt; <span class="string">'\n'</span>;        <span class="comment">// 1100 (SHL,assign)</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (foo&gt;&gt;=<span class="number">1</span>) &lt;&lt; <span class="string">'\n'</span>;        <span class="comment">// 0110 (SHR,assign)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (~bar) &lt;&lt; <span class="string">'\n'</span>;           <span class="comment">// 1100 (NOT)</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (bar&lt;&lt;<span class="number">1</span>) &lt;&lt; <span class="string">'\n'</span>;         <span class="comment">// 0110 (SHL)</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (bar&gt;&gt;<span class="number">1</span>) &lt;&lt; <span class="string">'\n'</span>;         <span class="comment">// 0001 (SHR)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (foo==bar) &lt;&lt; <span class="string">'\n'</span>;       <span class="comment">// false (0110==0011)</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (foo!=bar) &lt;&lt; <span class="string">'\n'</span>;       <span class="comment">// true  (0110!=0011)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (foo&amp;bar) &lt;&lt; <span class="string">'\n'</span>;        <span class="comment">// 0010</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (foo|bar) &lt;&lt; <span class="string">'\n'</span>;        <span class="comment">// 0111</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (foo^bar) &lt;&lt; <span class="string">'\n'</span>;        <span class="comment">// 0101</span></span><br></pre></td></tr></table></figure></p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><blockquote><p><a href="http://www.cplusplus.com/reference/bitset/bitset/" target="_blank" rel="noopener">C++ Reference</a></p><p><a href="https://blog.csdn.net/lanchunhui/article/details/49644373" target="_blank" rel="noopener">CSDN by Inside_Zhang</a></p><p><a href="https://www.cnblogs.com/RabbitHu/p/bitset.html" target="_blank" rel="noopener">èƒ¡å°å…”çš„OIåšå®¢</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> stl </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°è®º</title>
      <link href="/posts/15425/"/>
      <url>/posts/15425/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åˆå¼€äº†ä¸€ä¸ªä¸§å¿ƒç—…ç‹‚çš„å¤§å‘ï¼Œ<del>å‡ ä¸ªæœˆéƒ½æ‰“ä¸å®Œ</del>ï¼Œå¸Œæœ›noipå‰å¯ä»¥æ‰“çš„å®Œå§<del>ï¼ˆåˆæ˜¯ä¸€ä¸ªflagï¼‰</del></p></blockquote><a id="more"></a><h1 id="æœ€å¤§å…¬çº¦æ•°ï¼ˆGCDï¼‰"><a href="#æœ€å¤§å…¬çº¦æ•°ï¼ˆGCDï¼‰" class="headerlink" title="æœ€å¤§å…¬çº¦æ•°ï¼ˆGCDï¼‰"></a>æœ€å¤§å…¬çº¦æ•°ï¼ˆGCDï¼‰</h1><p>ä¸€èˆ¬ä½¿ç”¨<strong>æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆè¾—è½¬ç›¸é™¤æ³•ï¼‰</strong>æ±‚æœ€å¤§å…¬çº¦æ•°ï¼Œä½†åœ¨é«˜ç²¾æƒ…å†µä¸‹ï¼Œ<strong>%</strong>è¿ç®—è¿‡æ…¢ï¼Œæˆ‘ä»¬ä½¿ç”¨<strong>æ›´ç›¸æŸå‡æœ¯</strong>æ¥ä»£æ›¿<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span><span class="comment">//è¾—è½¬ç›¸é™¤æ³•</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(y==<span class="number">0</span>) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">return</span> gcd(y,x%y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span><span class="comment">//æ›´ç›¸æŸå‡æœ¯</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(a!=b)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">if</span>(a&gt;b) a-=b;</span><br><span class="line">        <span class="keyword">else</span> b-=a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æœ€å°å…¬å€æ•°ï¼ˆLCMï¼‰"><a href="#æœ€å°å…¬å€æ•°ï¼ˆLCMï¼‰" class="headerlink" title="æœ€å°å…¬å€æ•°ï¼ˆLCMï¼‰"></a>æœ€å°å…¬å€æ•°ï¼ˆLCMï¼‰</h1><p>æ±‚ä¸¤ä¸ªæ•° $x$ï¼Œ$y$ çš„æœ€å°å…¬å€æ•°ï¼Œæ˜“å¾— $lcm(x,y)=\frac {x*y}{gcd(x,y)}$</p><h1 id="ç´ æ•°"><a href="#ç´ æ•°" class="headerlink" title="ç´ æ•°"></a>ç´ æ•°</h1><h2 id="æš´åŠ›æ±‚è§£"><a href="#æš´åŠ›æ±‚è§£" class="headerlink" title="æš´åŠ›æ±‚è§£"></a>æš´åŠ›æ±‚è§£</h2><p>æ²¡å•¥å¥½è¯´çš„ã€‚ã€‚ã€‚æ—¶é—´å¤æ‚åº¦ $O(n^2)$<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_prime</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=<span class="built_in">sqrt</span>(x);i++)</span><br><span class="line">    <span class="keyword">if</span>(x%i==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="Eratosthenesç­›æ³•ï¼ˆåŸƒæ°ç­›ï¼‰"><a href="#Eratosthenesç­›æ³•ï¼ˆåŸƒæ°ç­›ï¼‰" class="headerlink" title="Eratosthenesç­›æ³•ï¼ˆåŸƒæ°ç­›ï¼‰"></a>Eratosthenesç­›æ³•ï¼ˆåŸƒæ°ç­›ï¼‰</h2><p>æˆ‘ä»¬å€’ç€æ¥æƒ³ï¼Œå› ä¸ºä¸€ä¸ªæ•°çš„å€æ•°ä¸å¯èƒ½æ˜¯è´¨æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä» $2$ å¼€å§‹å¾€ä¸Šç­›ï¼Œå‘ç°ä¸€ä¸ªæ•°æ²¡æœ‰è¢«æ ‡è®°è¿‡ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°è‚¯å®šå°±æ˜¯ä¸€ä¸ªè´¨æ•°ï¼Œå†æŠŠå®ƒçš„å€æ•°æ‰“ä¸ªæ ‡è®°ï¼Œæ—¶é—´å¤æ‚åº¦ $O(nloglogn)$<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ±‚1~nçš„æ‰€æœ‰è´¨æ•°</span></span><br><span class="line"><span class="keyword">bool</span> prime[<span class="number">10000000</span>+<span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_prime</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">int</span> i, j;</span><br><span class="line">   <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++) prime[i]=<span class="number">1</span>;</span><br><span class="line">    prime[<span class="number">1</span>]=<span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">2</span>; i&lt;=n; i++)  </span><br><span class="line">    &#123;  </span><br><span class="line">    <span class="keyword">if</span> (!prime[i]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (j=i*<span class="number">2</span>;j&lt;=n;j+=i) prime[j]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="Eulerç­›æ³•ï¼ˆæ¬§æ‹‰ç­›ï¼‰"><a href="#Eulerç­›æ³•ï¼ˆæ¬§æ‹‰ç­›ï¼‰" class="headerlink" title="Eulerç­›æ³•ï¼ˆæ¬§æ‹‰ç­›ï¼‰"></a>Eulerç­›æ³•ï¼ˆæ¬§æ‹‰ç­›ï¼‰</h2><p>æ¬§æ‹‰ç­›æ˜¯åŸƒæ°ç­›çš„ä¼˜åŒ–ï¼Œåœ¨åŸƒæ°ç­›çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æœ‰ä¸€äº›æ•°è¢«ç­›äº†å¤šæ¬¡ï¼Œä¾‹å¦‚ $6$ ,åœ¨ $2$ å’Œ $3$ çš„æ—¶å€™éƒ½è¢«ç­›äº†ä¸€æ¬¡ï¼Œå‡å¦‚æˆ‘ä»¬å¯ä»¥é¿å…è¿™äº›é‡å¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥åšåˆ° $O(n)$ çš„æ—¶é—´å¤æ‚åº¦ï¼Œå…ˆç»™å‡ºä»£ç <br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ±‚1~nçš„æ‰€æœ‰è´¨æ•°</span></span><br><span class="line"><span class="keyword">int</span> prime[<span class="number">10000000</span>+<span class="number">5</span>],ntpri[<span class="number">10000000</span>+<span class="number">5</span>],tot;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_prime</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ntpri[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">if</span>(!ntpri[i]) pri[++tot]=i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=tot&amp;&amp;i*pri[j]&lt;=n;j++)</span><br><span class="line">        &#123;</span><br><span class="line">        ntpri[pri[j]*i]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>) <span class="keyword">break</span>;<span class="comment">//å…³é”®</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™å¥ <code>if(i%pri[j]==0) break;</code> æ˜¯å…³é”®æ‰€åœ¨</p><p>å‡è®¾æˆ‘ä»¬ç­›åˆ°äº†ç¬¬ $i$ ä¸ªæ•°ï¼Œå¾ªç¯åˆ° $prime[j]$ ï¼Œ</p><p>å¦‚æœ $prime[j]|i$ ï¼Œé‚£ä¹ˆå¿…å®šæœ‰ä¸€ä¸ªæ•° $x$   ï¼Œä½¿å¾— $i=x \cdot prime[j]$ ï¼Œ</p><p>é‚£ä¹ˆå¦‚æœä¸‹ä¸€ä¸ªæ•° $prime[j+1]$ å’Œ $i$ ç›¸ä¹˜ï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªæ•° $p$ ï¼Œ</p><p>è€Œ $p=prime[j+1] \cdot i=prime[j+1] \cdot x \cdot prime[j]=k*prime[j]$</p><p>è®¾ $k=prime[j+1] \cdot x$ ï¼Œ</p><p>å³ $prime[j+1] \cdot i=k \cdot prime[j]$</p><p>æ‰€ä»¥åœ¨æœªæ¥ä¸€å®šæœ‰ä¸€ä¸ªæ•°ä¹˜ä»¥ $prime[j]$ æ°å¥½å¯ä»¥æŠŠ $p$ ç­›æ‰ï¼Œä¸å¿…è¦å†åˆ° $prime[j+1]$ ç­›è¿™ä¸ªæ•°</p><h2 id="Miller-Rabinç®—æ³•"><a href="#Miller-Rabinç®—æ³•" class="headerlink" title="Miller Rabinç®—æ³•"></a>Miller Rabinç®—æ³•</h2><p><strong>Miller Rabin</strong> æ˜¯ä¾æ®äºè´¹é©¬å°å®šç†çš„ä¸€ä¸ª <strong>éšæœºç®—æ³•</strong> ï¼Œå…ˆä»‹ç»è´¹é©¬å°å®šç†<br>$$<br>a^{P-1}\equiv 1(modP)<br>$$<br>å…¶ä¸­ $P$ ä¸ºè´¨æ•°ï¼Œä¸” $gcd(a,P)=1$ ï¼Œ</p><p>å‡å¦‚æœ‰ä¸€ä¸ªæ•° $P$ å¯¹äºä»»ä½• $a$ æ»¡è¶³è¯¥æ€§è´¨ï¼Œé‚£ä¹ˆ $P$ æ˜¯ä¸æ˜¯å°±æ˜¯è´¨æ•°å‘¢ï¼Ÿ</p><p>ç„¶è€Œè¿™æ˜¯é”™è¯¯çš„ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª<del>ä¸“é—¨é’ˆå¯¹å®ƒ</del>çš„åä¾‹ï¼š å¡è¿ˆå…‹å°”æ•°ï¼ˆCarmichaelæ•°ï¼‰</p><blockquote><p>å¡è¿ˆå…‹å°”æ•°çš„å®šä¹‰æ˜¯å¯¹äºåˆæ•° $n$ï¼Œå¦‚æœå¯¹äºæ‰€æœ‰æ­£æ•´æ•° $b$ï¼Œ$b$ å’Œ $n$ äº’ç´ ï¼Œ</p><p>éƒ½æœ‰åŒä½™å¼ $b^{N-1}â‰¡ 1 (mod N)$ æˆç«‹ï¼Œåˆ™åˆæ•° $n$ ä¸ºCarmichaelæ•°ã€‚</p></blockquote><p>ä½†æ˜¯æˆ‘ä»¬ä»»ç„¶å¯ä»¥é€šè¿‡è´¹é©¬å°å®šç†æ¥æ±‚ç´ æ•°ï¼Œæ¯•ç«Ÿ100000000ä»¥å†…åªæœ‰255ä¸ªå¡ç±³åˆ‡å°”æ•°ï¼Œ</p><p>åªè¦æˆ‘ä»¬å¤šæ¬¡è®¡ç®—ï¼Œä»»ç„¶å¯ä»¥ä¿è¯ 99.9% ä»¥ä¸Šçš„æ­£ç¡®ç‡ï¼Œ</p><p><del>ä½†å®ƒè¿˜æ˜¯ä¸ªç„å­¦ç®—æ³•ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥èƒŒä¸‹ä¸€äº›intä»¥å†…æ‰€æœ‰å¡è¿ˆå…‹å°”æ•°</del> ï¼Œ</p><p><del>å…ˆå’•å’•å’•</del></p><h1 id="çŸ©é˜µ"><a href="#çŸ©é˜µ" class="headerlink" title="çŸ©é˜µ"></a>çŸ©é˜µ</h1><h2 id="çŸ©é˜µä¹˜æ³•"><a href="#çŸ©é˜µä¹˜æ³•" class="headerlink" title="çŸ©é˜µä¹˜æ³•"></a>çŸ©é˜µä¹˜æ³•</h2><p>ä¸¾ä¸ªæ —å­ï¼ˆæ¥è‡ªç™¾åº¦ç™¾ç§‘ï¼‰</p><p><img src="https://upload-images.jianshu.io/upload_images/13056869-629066d94eae426c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p>è®¾ $A$ ä¸º $n \times k$ é˜¶çš„çŸ©é˜µ ï¼Œ$B$ ä¸º $k \times m$ é˜¶çš„çŸ©é˜µ</p><p>åˆ™ $C=A \cdot B$ å¯ä»¥è¡¨ç¤ºä¸º $C_{i,j}=\sum_{p=1}^{k}A_{i,p} \times B_{p,j}$</p><p><img src="https://upload-images.jianshu.io/upload_images/13056869-889379c6038a93c5.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">105</span>][<span class="number">105</span>];</span><br><span class="line"><span class="keyword">int</span> b[<span class="number">105</span>][<span class="number">105</span>];</span><br><span class="line"><span class="keyword">int</span> c[<span class="number">105</span>][<span class="number">105</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> n,m,k;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m&gt;&gt;k;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> t=<span class="number">1</span>;t&lt;=m;t++)</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;a[i][t];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> t=<span class="number">1</span>;t&lt;=k;t++)</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;b[i][t];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=k;j++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> t=<span class="number">1</span>;t&lt;=m;t++)</span><br><span class="line">c[i][j]+=a[i][t]*b[t][j];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> t=<span class="number">1</span>;t&lt;=k;t++)</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;c[i][t]&lt;&lt;<span class="string">' '</span>;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="çŸ©é˜µå¿«é€Ÿå¹‚"><a href="#çŸ©é˜µå¿«é€Ÿå¹‚" class="headerlink" title="çŸ©é˜µå¿«é€Ÿå¹‚"></a>çŸ©é˜µå¿«é€Ÿå¹‚</h2><p>å…ˆè®² <strong>å¿«é€Ÿå¹‚</strong>ï¼Œè¿˜æ˜¯åˆ©ç”¨äºŒè¿›åˆ¶çš„æ€æƒ³<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//æ±‚xçš„kæ¬¡æ–¹</span><br><span class="line">typedef long long LL;</span><br><span class="line">LL fastpow(LL x,LL k)</span><br><span class="line">ï½›</span><br><span class="line">LL ans=1;</span><br><span class="line">    while(k)</span><br><span class="line">    &#123;</span><br><span class="line">    if(k&amp;1) ans*=x;</span><br><span class="line">        x*=x;</span><br><span class="line">        k&gt;&gt;=1;</span><br><span class="line">    &#125;</span><br><span class="line">    return ans;</span><br><span class="line">ï½</span><br></pre></td></tr></table></figure></p><p>çŸ©é˜µå¿«é€Ÿå¹‚å°±æ˜¯æŠŠä¹˜æ¢æˆçŸ©é˜µä¹˜QWQ<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> LL M=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">data</span> &#123;</span></span><br><span class="line">    LL matrix[<span class="number">105</span>][<span class="number">105</span>];</span><br><span class="line">&#125;;</span><br><span class="line">data a,eans;</span><br><span class="line">LL n,k;</span><br><span class="line"><span class="function">data <span class="title">mul</span><span class="params">(data a,data b)</span> </span>&#123;</span><br><span class="line">    data ans;</span><br><span class="line">    <span class="built_in">memset</span>(ans.matrix,<span class="number">0</span>,<span class="keyword">sizeof</span>(ans.matrix));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>; k&lt;=n; ++k) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> t=<span class="number">1</span>; t&lt;=n; ++t) &#123;</span><br><span class="line">                ans.matrix[i][k]=ans.matrix[i][k]%M+a.matrix[i][t]*b.matrix[t][k]%M;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">data <span class="title">fastpow</span><span class="params">(data a,LL b)</span> </span>&#123;</span><br><span class="line">    data ans;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; ++i)</span><br><span class="line">        ans.matrix[i][i]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b!=<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans=mul(ans,a);</span><br><span class="line">        a=mul(a,a);</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//freopen("testdata (1).in","r",stdin);</span></span><br><span class="line"><span class="comment">//freopen("1.txt","w",stdout);</span></span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; ++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>; k&lt;=n; ++k)</span><br><span class="line">            <span class="built_in">cin</span>&gt;&gt;a.matrix[i][k];</span><br><span class="line">    </span><br><span class="line">    eans=fastpow(a,k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>; k&lt;=n; ++k)</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;eans.matrix[i][k]%M&lt;&lt;<span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="çŸ©é˜µåŠ é€Ÿ"><a href="#çŸ©é˜µåŠ é€Ÿ" class="headerlink" title="çŸ©é˜µåŠ é€Ÿ"></a>çŸ©é˜µåŠ é€Ÿ</h2><pre><code></code></pre><p><del>å’•å’•å’•</del></p><h1 id="é€†å…ƒ"><a href="#é€†å…ƒ" class="headerlink" title="é€†å…ƒ"></a>é€†å…ƒ</h1><h2 id="è´¹é©¬å°å®šç†"><a href="#è´¹é©¬å°å®šç†" class="headerlink" title="è´¹é©¬å°å®šç†"></a>è´¹é©¬å°å®šç†</h2><h2 id="EXGCD"><a href="#EXGCD" class="headerlink" title="EXGCD"></a>EXGCD</h2><h2 id="çº¿æ€§æ±‚é€†å…ƒ"><a href="#çº¿æ€§æ±‚é€†å…ƒ" class="headerlink" title="çº¿æ€§æ±‚é€†å…ƒ"></a>çº¿æ€§æ±‚é€†å…ƒ</h2><h1 id="è®¡ç®—ç›¸å…³"><a href="#è®¡ç®—ç›¸å…³" class="headerlink" title="è®¡ç®—ç›¸å…³"></a>è®¡ç®—ç›¸å…³</h1><h2 id="é«˜æ–¯æ¶ˆå…ƒ"><a href="#é«˜æ–¯æ¶ˆå…ƒ" class="headerlink" title="é«˜æ–¯æ¶ˆå…ƒ"></a>é«˜æ–¯æ¶ˆå…ƒ</h2><h2 id="BSGSç®—æ³•"><a href="#BSGSç®—æ³•" class="headerlink" title="BSGSç®—æ³•"></a>BSGSç®—æ³•</h2><h2 id="é«˜ç²¾"><a href="#é«˜ç²¾" class="headerlink" title="é«˜ç²¾"></a>é«˜ç²¾</h2><h2 id="FFT"><a href="#FFT" class="headerlink" title="FFT"></a>FFT</h2><h2 id="NTT"><a href="#NTT" class="headerlink" title="NTT"></a>NTT</h2><h1 id="ç»„åˆæ•°å­¦"><a href="#ç»„åˆæ•°å­¦" class="headerlink" title="ç»„åˆæ•°å­¦"></a>ç»„åˆæ•°å­¦</h1><h2 id="lucaså®šç†"><a href="#lucaså®šç†" class="headerlink" title="lucaså®šç†"></a>lucaså®šç†</h2><h2 id="Burnsideå¼•ç†"><a href="#Burnsideå¼•ç†" class="headerlink" title="Burnsideå¼•ç†"></a>Burnsideå¼•ç†</h2><h2 id="Polyaå®šç†"><a href="#Polyaå®šç†" class="headerlink" title="Polyaå®šç†"></a>Polyaå®šç†</h2><h1 id="ç¾¤"><a href="#ç¾¤" class="headerlink" title="ç¾¤"></a>ç¾¤</h1><h2 id="ç½®æ¢ç¾¤åŠè½®æ¢"><a href="#ç½®æ¢ç¾¤åŠè½®æ¢" class="headerlink" title="ç½®æ¢ç¾¤åŠè½®æ¢"></a>ç½®æ¢ç¾¤åŠè½®æ¢</h2><h1 id="åæ¼”"><a href="#åæ¼”" class="headerlink" title="åæ¼”"></a>åæ¼”</h1><h2 id="ç§¯æ€§å‡½æ•°"><a href="#ç§¯æ€§å‡½æ•°" class="headerlink" title="ç§¯æ€§å‡½æ•°"></a>ç§¯æ€§å‡½æ•°</h2><h3 id="æ¬§æ‹‰å‡½æ•°"><a href="#æ¬§æ‹‰å‡½æ•°" class="headerlink" title="æ¬§æ‹‰å‡½æ•°"></a>æ¬§æ‹‰å‡½æ•°</h3><h3 id="è«æ¯”ä¹Œæ–¯å‡½æ•°"><a href="#è«æ¯”ä¹Œæ–¯å‡½æ•°" class="headerlink" title="è«æ¯”ä¹Œæ–¯å‡½æ•°"></a>è«æ¯”ä¹Œæ–¯å‡½æ•°</h3><h2 id="åŸæ ¹"><a href="#åŸæ ¹" class="headerlink" title="åŸæ ¹"></a>åŸæ ¹</h2><h2 id="å·ç§¯"><a href="#å·ç§¯" class="headerlink" title="å·ç§¯"></a>å·ç§¯</h2><h2 id="è«æ¯”ä¹Œæ–¯åæ¼”"><a href="#è«æ¯”ä¹Œæ–¯åæ¼”" class="headerlink" title="è«æ¯”ä¹Œæ–¯åæ¼”"></a>è«æ¯”ä¹Œæ–¯åæ¼”</h2><h2 id="æœæ•™ç­›"><a href="#æœæ•™ç­›" class="headerlink" title="æœæ•™ç­›"></a>æœæ•™ç­›</h2><h2 id="æ´²é˜ç­›"><a href="#æ´²é˜ç­›" class="headerlink" title="æ´²é˜ç­›"></a>æ´²é˜ç­›</h2><h1 id="æ‚é¡¹"><a href="#æ‚é¡¹" class="headerlink" title="æ‚é¡¹"></a>æ‚é¡¹</h1><h2 id="è£´èœ€å®šç†"><a href="#è£´èœ€å®šç†" class="headerlink" title="è£´èœ€å®šç†"></a>è£´èœ€å®šç†</h2><h2 id="æ¬§æ‹‰å®šç†"><a href="#æ¬§æ‹‰å®šç†" class="headerlink" title="æ¬§æ‹‰å®šç†"></a>æ¬§æ‹‰å®šç†</h2><h2 id="ä¸­å›½å‰©ä½™å®šç†"><a href="#ä¸­å›½å‰©ä½™å®šç†" class="headerlink" title="ä¸­å›½å‰©ä½™å®šç†"></a>ä¸­å›½å‰©ä½™å®šç†</h2>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°è®º </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Balance Tree(FHQ Treap)</title>
      <link href="/posts/31323/"/>
      <url>/posts/31323/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å¬è¯´è¿™ä¸ªå¹³è¡¡æ ‘å¾ˆ<del>å¥½å†™</del>ï¼Œæ‰€ä»¥æˆ‘å°è¯•å»å­¦ä¸€ä¸‹è¿™ä¸ª<del>æ¯’ç˜¤</del>çš„æ•°æ®ç»“æ„</p></blockquote><h1 id="FHQ-Treapç®€ä»‹"><a href="#FHQ-Treapç®€ä»‹" class="headerlink" title="FHQ Treapç®€ä»‹"></a>FHQ Treapç®€ä»‹</h1><p>FHQ Treapåªæœ‰ä¸¤ç§ä¸»è¦çš„æ“ä½œ</p><ul><li>åˆ†ç¦»ï¼ˆsplitï¼‰ æŠŠä¸€æ£µæ ‘åˆ†æˆä¸¤ä¸ªæ ‘</li><li>åˆå¹¶ï¼ˆmergeï¼‰ æŠŠä¸¤æ£µæ ‘åˆæˆä¸€æ£µæ ‘</li></ul><p>é€šè¿‡ <strong>åˆ†ç¦»</strong> å’Œ <strong>åˆå¹¶</strong> çš„æ“ä½œï¼ŒFHQ Treapå¯ä»¥å®Œæˆæ™®é€šå¹³è¡¡æ ‘çš„å¾ˆå¤šæ“ä½œ</p><ol><li>æ’å…¥ </li><li>åˆ é™¤</li><li>æŸ¥è¯¢æ’åä¸º $i$ çš„æ•°</li><li>æŸ¥è¯¢ $wei$ çš„æ’å</li><li>æ±‚ $wei$ çš„å‰é©±</li><li>æ±‚ $wei$ çš„åç»§</li><li>åè½¬åŒºé—´</li></ol><a id="more"></a><h1 id="æ ‘çš„èŠ‚ç‚¹"><a href="#æ ‘çš„èŠ‚ç‚¹" class="headerlink" title="æ ‘çš„èŠ‚ç‚¹"></a>æ ‘çš„èŠ‚ç‚¹</h1><p>FHQ Treap çš„èŠ‚ç‚¹ç»´æŠ¤çš„ æ™®é€šTreap ç»´æŠ¤çš„å¤§è‡´ç›¸åŒï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç»“æ„ä½“æ¥ä¿å­˜ä¿¡æ¯<br>ç›¸å…³å«ä¹‰å¦‚ä¸‹ï¼š</p><ul><li><code>size</code> â€”&gt; å­æ ‘ï¼ˆåŒ…æ‹¬è‡ªèº«ï¼‰çš„å¤§å°</li><li><code>val</code> â€”&gt; è¯¥èŠ‚ç‚¹çš„å€¼</li><li><code>rnd</code> â€”&gt; Treapä¸­ç”¨äºå †çš„éšæœºå€¼</li><li><code>l</code> <code>r</code> â€”&gt; å·¦èŠ‚ç‚¹å’Œå³èŠ‚ç‚¹</li></ul><p>ä¸‹é¢ç»™å‡ºä»£ç ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FHQ</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> size,val,rnd;</span><br><span class="line">&#125;tr[N];</span><br></pre></td></tr></table></figure></p><h1 id="æ“ä½œ-1-æ’å…¥"><a href="#æ“ä½œ-1-æ’å…¥" class="headerlink" title="æ“ä½œ 1 : æ’å…¥"></a>æ“ä½œ 1 : æ’å…¥</h1><p>æŒ‰ç…§æ™®é€štreapçš„å†™æ³•ï¼Œæˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œéœ€è¦è°ƒç”¨newnodeå‡½æ•°<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> tot=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">newnode</span><span class="params">(<span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[++tot].size=<span class="number">1</span>;tr[tot].val=v,tr[tot].rnd=rand();</span><br><span class="line">    <span class="keyword">return</span> tot;<span class="comment">//è¿”å›æ–°èŠ‚ç‚¹çš„ç¼–å·</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬å¯ä»¥æŠŠåŸæ¥çš„æ•°æŒ‰æ–°èŠ‚ç‚¹çš„å€¼åˆ†æˆä¸¤ä»½ï¼Œå†ä¾æ¬¡åˆå¹¶ï¼Œå°±å®Œæˆäº†æ’å…¥çš„è¿‡ç¨‹<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> wei)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x,y;</span><br><span class="line">    spilt(root,wei,x,y);</span><br><span class="line">    <span class="comment">//rootè¡¨ç¤ºç›®å‰æ€»æ ‘çš„æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="comment">//æŠŠæ€»æ ‘åˆ†æˆä»¥x,yä¸ºæ ¹èŠ‚ç‚¹çš„ä¸¤æ£µæ ‘</span></span><br><span class="line">    root=merge(merge(x,newnode(wei)),y);</span><br><span class="line">    <span class="comment">//åˆå¹¶æ‰€æœ‰å­æ ‘å¹¶é‡ç½®æ ¹èŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="æ“ä½œ-2-ï¼š-åˆ é™¤"><a href="#æ“ä½œ-2-ï¼š-åˆ é™¤" class="headerlink" title="æ“ä½œ 2 ï¼š åˆ é™¤"></a>æ“ä½œ 2 ï¼š åˆ é™¤</h1><p>åˆ é™¤æƒå€¼ä¸º $wei$ çš„ç‚¹ï¼Œå…ˆæŠŠæ•´é¢—æ ‘ä»¥ $wei$ ä¸ºæƒå€¼ $split$ æˆä¸¤æ£µæ ‘ $x$ï¼Œ$y$ï¼Œå†æŠŠ $x$ æ ‘æŒ‰ç…§ $wei-1$ åˆ†æˆ $p$ï¼Œ$q$ã€‚</p><p>è¿™æ—¶å€™å€¼ä¸ºweiçš„ç‚¹ä¸€å®šä¸º $q$ çš„æ ¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠ $q$ çš„ä¸¤ä¸ªå­å„¿å­ $merge$ èµ·æ¥ï¼ˆè¿™ä¸€æ­¥å°±æ˜¯å»é™¤æ‰ $wei$ çš„å½±å“ï¼‰ï¼Œå†æŠŠä»–ä»¬é‡æ–° $merge$ èµ·æ¥å¾—åˆ°ä¸€ä¸ªæ–°çš„æ ‘ï¼Œè¿™é¢—æ ‘å°±å»é™¤æ‰äº† $wei$ çš„å½±å“ã€‚<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> wei)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> p,<span class="keyword">int</span> q;</span><br><span class="line">    spilt(root,wei,x,y);</span><br><span class="line">    split(x,wei<span class="number">-1</span>,p,q);</span><br><span class="line">    q=merge(tr[q].l,tr[q].r);</span><br><span class="line">    root=merge(merge(p,q),y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="æ“ä½œ-3-ï¼š-æŸ¥è¯¢æ’åä¸º-i-çš„æ•°"><a href="#æ“ä½œ-3-ï¼š-æŸ¥è¯¢æ’åä¸º-i-çš„æ•°" class="headerlink" title="æ“ä½œ 3 ï¼š æŸ¥è¯¢æ’åä¸º i çš„æ•°"></a>æ“ä½œ 3 ï¼š æŸ¥è¯¢æ’åä¸º i çš„æ•°</h1><p>å’Œæ™®é€šTreapæ˜¯ä¸€æ ·çš„ï¼Œ</p><p>ä½†æ³¨æ„ï¼Œ<strong>è¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯ æ’åä¸º <em>i</em> çš„æ•° çš„èŠ‚ç‚¹ç¼–å·kï¼ˆå€¼ä¸ºtr[k].valï¼‰</strong> ã€‚<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getNum</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> rk)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(rk&lt;=tr[tr[now].l].size) now=tr[now].l;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(rk==tr[tr[now].l].size+<span class="number">1</span>) <span class="keyword">return</span> now;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                rk-=tr[re[now].l].size+<span class="number">1</span>;</span><br><span class="line">                now=tr[now].r;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="æ“ä½œ-4-ï¼š-æŸ¥è¯¢-wei-çš„æ’å"><a href="#æ“ä½œ-4-ï¼š-æŸ¥è¯¢-wei-çš„æ’å" class="headerlink" title="æ“ä½œ 4 ï¼š æŸ¥è¯¢ wei çš„æ’å"></a>æ“ä½œ 4 ï¼š æŸ¥è¯¢ wei çš„æ’å</h1><p>æŠŠæ€»æ ‘æŒ‰ $wei$ è¿›è¡Œ $spilt$ ï¼Œå¾—åˆ°å·¦éƒ¨åˆ†æ ‘çš„å¤§å°å³ä¸ºrankå€¼ã€‚<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getRank</span><span class="params">(<span class="keyword">int</span> wei)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x,y;</span><br><span class="line">    spilt(root,wei,x,y);</span><br><span class="line">    <span class="keyword">return</span> tr[x].size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="æ“ä½œ-5-ï¼š-æ±‚-wei-çš„å‰é©±"><a href="#æ“ä½œ-5-ï¼š-æ±‚-wei-çš„å‰é©±" class="headerlink" title="æ“ä½œ 5 ï¼š æ±‚ wei çš„å‰é©±"></a>æ“ä½œ 5 ï¼š æ±‚ wei çš„å‰é©±</h1><p>æŠŠæ€»æ ‘æŒ‰ $wei-1$ åˆ†æˆä¸¤ä»½ï¼Œ<br>æ‰€ä»¥å°äº $wei$ çš„èŠ‚ç‚¹éƒ½åœ¨å·¦éƒ¨åˆ†æ ‘ä¸­ï¼Œåªéœ€è¦æ±‚å‡ºå·¦éƒ¨åˆ†æ ‘çš„sizeæ‰€å¯¹åº”çš„èŠ‚ç‚¹çš„å€¼ï¼Œ<br>å°±æ˜¯æ‰€æ±‚çš„ $wei$ çš„å‰é©±ã€‚<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pre</span><span class="params">(<span class="keyword">int</span> wei)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x,y;</span><br><span class="line">    spilt(root,wei<span class="number">-1</span>,x,y);</span><br><span class="line">    <span class="keyword">return</span> tr[getNum(x,tr[x].size)].val;</span><br><span class="line">    root=merge(x,y);<span class="comment">//å›å¤åŸçŠ¶</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="æ“ä½œ-6-ï¼š-æ±‚-wei-çš„åç»§"><a href="#æ“ä½œ-6-ï¼š-æ±‚-wei-çš„åç»§" class="headerlink" title="æ“ä½œ 6 ï¼š æ±‚ wei çš„åç»§"></a>æ“ä½œ 6 ï¼š æ±‚ wei çš„åç»§</h1><p>æ‰¾åç»§æ˜¯ç›¸åŒçš„ï¼ŒæŠŠæ€»æ ‘æŒ‰ $wei$ ä¸ºæƒå€¼è°ƒç”¨ $split$ï¼Œæ­¤æ—¶å³éƒ¨åˆ†æ ‘æ’åç¬¬ä¸€çš„æ•°å°±æ˜¯åç»§<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">suc</span><span class="params">(<span class="keyword">int</span> wei)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x,y;</span><br><span class="line">    spilt(root,wei+<span class="number">1</span>,x,y);</span><br><span class="line">    <span class="keyword">return</span> tr[getNum(y,<span class="number">1</span>)].val;</span><br><span class="line">    root=merge(x,y);<span class="comment">//å›å¤åŸçŠ¶</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="æ“ä½œ-7-ï¼š-åè½¬åŒºé—´"><a href="#æ“ä½œ-7-ï¼š-åè½¬åŒºé—´" class="headerlink" title="æ“ä½œ 7 ï¼š åè½¬åŒºé—´"></a>æ“ä½œ 7 ï¼š åè½¬åŒºé—´</h1><p><del>å…ˆå’•ç€ï¼Œæœ‰ç©ºè¡¥</del></p><h1 id="æ ¸å¿ƒ-1ï¼š-merge-æ“ä½œ"><a href="#æ ¸å¿ƒ-1ï¼š-merge-æ“ä½œ" class="headerlink" title="æ ¸å¿ƒ 1ï¼š merge æ“ä½œ"></a>æ ¸å¿ƒ 1ï¼š merge æ“ä½œ</h1><p>$merge$ æ“ä½œå³æŒ‰ç…§ FHQ Treap çš„é™„åŠ æƒå€¼<del>ç„å­¦</del>ç»´æŒå¹³è¡¡å¹¶è¿›è¡Œåˆå¹¶<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span><span class="comment">//x æ’&lt; y ,æ‰€ä»¥éœ€è¦ä¿è¯é¡ºåº</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!x||!y) <span class="keyword">return</span> x+y;</span><br><span class="line">    update(x),update(y);</span><br><span class="line">    <span class="keyword">if</span>(tr[x].rnd&lt;tr[y].rnd)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[x].r=merge(tr[x].r,y);</span><br><span class="line">        update(x);</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        tr[y].l=merge(x,tr[y].l);</span><br><span class="line">        update(y);</span><br><span class="line">        <span class="keyword">return</span> y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="æ ¸å¿ƒ-2ï¼š-spilt-æ“ä½œ"><a href="#æ ¸å¿ƒ-2ï¼š-spilt-æ“ä½œ" class="headerlink" title="æ ¸å¿ƒ 2ï¼š spilt æ“ä½œ"></a>æ ¸å¿ƒ 2ï¼š spilt æ“ä½œ</h1><p>$split$ æ˜¯æŠŠä¸€é¢—Treapåˆ†å¼€ä¸¤ä¸ªæ ‘çš„æ“ä½œã€‚</p><p>æœ‰ä¸¤ç§åˆ†æ³•ï¼Œä¸€ç§æ˜¯æŒ‰æƒå€¼åˆ†ï¼Œä¸€ç§æ˜¯æŒ‰$size$ï¼ˆå­æ ‘å¤§å°ï¼‰åˆ†ï¼Œå…·ä½“ç”¨å“ªä¸ªè¦çœ‹æƒ…å†µã€‚</p><p>æŒ‰æƒå€¼åˆ† <strong>æ³¨æ„è¿™æ—¶å€™æƒå€¼å°äºç­‰äº kçš„èŠ‚ç‚¹éƒ½åœ¨å·¦æ ‘ä¸­ï¼Œå¤§äº kçš„éƒ½åœ¨å³æ ‘ä¸­</strong> ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spilt</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> val,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!now) x=y=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(val&lt;=tr[tr[now].l].val)</span><br><span class="line">            y=now,spilt(tr[now].l,val,x,tr[now].l);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            x=now,spilt(tr[now].r,val,tr[now].r,y);</span><br><span class="line">        update(now);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‰ $size$ åˆ† ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spilt</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> rnk,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!now) x=y=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(rnk&lt;=tr[tr[now].l].size)</span><br><span class="line">            y=now,spilt(tr[now].l,rnk,x,tr[now].l);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            x=now,spilt(tr[now].r,rnk-tr[tr[now].l].size<span class="number">-1</span>,tr[now].r,y);</span><br><span class="line">        update(now);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="END"><a href="#END" class="headerlink" title="END"></a>END</h1>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> æ¨¡ç‰ˆ </tag>
            
            <tag> FHQ Treap </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è«é˜Ÿ</title>
      <link href="/posts/20389/"/>
      <url>/posts/20389/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ä»¬ä½¿ç”¨ä¸€é“ä¾‹é¢˜æ¥å¸®åŠ©æˆ‘ä»¬ç†è§£è«é˜Ÿç®—æ³•</p><p><a href="https://www.luogu.org/problemnew/show/P1972" target="_blank" rel="noopener">æ´›è°·P1972</a></p><a id="more"></a><h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°:"></a>é¢˜ç›®æè¿°:</h2><p>HH æœ‰ä¸€ä¸²ç”±å„ç§æ¼‚äº®çš„è´å£³ç»„æˆçš„é¡¹é“¾ã€‚HH ç›¸ä¿¡ä¸åŒçš„è´å£³ä¼šå¸¦æ¥å¥½è¿ï¼Œæ‰€ä»¥æ¯æ¬¡æ•£æ­¥å®Œåï¼Œ<br>ä»–éƒ½ä¼šéšæ„å–å‡ºä¸€æ®µè´å£³ï¼Œæ€è€ƒå®ƒä»¬æ‰€è¡¨è¾¾çš„å«ä¹‰ã€‚HH ä¸æ–­åœ°æ”¶é›†æ–°çš„è´å£³ï¼Œå› æ­¤ï¼Œ<br>ä»–çš„é¡¹é“¾å˜å¾—è¶Šæ¥è¶Šé•¿ã€‚æœ‰ä¸€å¤©ï¼Œä»–çªç„¶æå‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼šæŸä¸€æ®µè´å£³ä¸­ï¼ŒåŒ…å«äº†å¤šå°‘ç§ä¸åŒçš„è´å£³ï¼Ÿ<br>è¿™ä¸ªé—®é¢˜å¾ˆéš¾å›ç­”â€¦â€¦å› ä¸ºé¡¹é“¾å®åœ¨æ˜¯å¤ªé•¿äº†ã€‚äºæ˜¯ï¼Œä»–åªå¥½æ±‚åŠ©ç¿æ™ºçš„ä½ æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id="è¾“å…¥è¾“å‡ºæ ¼å¼"><a href="#è¾“å…¥è¾“å‡ºæ ¼å¼" class="headerlink" title="è¾“å…¥è¾“å‡ºæ ¼å¼:"></a>è¾“å…¥è¾“å‡ºæ ¼å¼:</h2><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>ç¬¬ä¸€è¡Œï¼šä¸€ä¸ªæ•´æ•°Nï¼Œè¡¨ç¤ºé¡¹é“¾çš„é•¿åº¦ã€‚</p><p>ç¬¬äºŒè¡Œï¼šN ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºä¾æ¬¡è¡¨ç¤ºé¡¹é“¾ä¸­è´å£³çš„ç¼–å·ï¼ˆç¼–å·ä¸º0 åˆ°1000000 ä¹‹é—´çš„æ•´æ•°ï¼‰ã€‚</p><p>ç¬¬ä¸‰è¡Œï¼šä¸€ä¸ªæ•´æ•°Mï¼Œè¡¨ç¤ºHH è¯¢é—®çš„ä¸ªæ•°ã€‚</p><p>æ¥ä¸‹æ¥M è¡Œï¼šæ¯è¡Œä¸¤ä¸ªæ•´æ•°ï¼ŒL å’ŒRï¼ˆ1 â‰¤ L â‰¤ R â‰¤ Nï¼‰ï¼Œè¡¨ç¤ºè¯¢é—®çš„åŒºé—´ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>M è¡Œï¼Œæ¯è¡Œä¸€ä¸ªæ•´æ•°ï¼Œä¾æ¬¡è¡¨ç¤ºè¯¢é—®å¯¹åº”çš„ç­”æ¡ˆã€‚</p><h2 id="è¾“å…¥è¾“å‡ºæ ·ä¾‹"><a href="#è¾“å…¥è¾“å‡ºæ ·ä¾‹" class="headerlink" title="è¾“å…¥è¾“å‡ºæ ·ä¾‹"></a>è¾“å…¥è¾“å‡ºæ ·ä¾‹</h2><h3 id="è¾“å…¥æ ·ä¾‹-1"><a href="#è¾“å…¥æ ·ä¾‹-1" class="headerlink" title="è¾“å…¥æ ·ä¾‹#1:"></a>è¾“å…¥æ ·ä¾‹#1:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">3</span> <span class="number">5</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="number">5</span></span><br><span class="line"><span class="number">2</span> <span class="number">6</span></span><br></pre></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹-1ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹-1ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹#1ï¼š"></a>è¾“å‡ºæ ·ä¾‹#1ï¼š</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure><h1 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h1><p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœç”¨æš´åŠ›ç®—æ³•è¿›è¡Œæ±‚è§£çš„è¯ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©å¼€ä¸€ä¸ª$cnt$æ•°ç»„ï¼Œéå†åŒºé—´ï¼Œç´¯åŠ æ±‚è§£ï¼Œ</p><p>æ˜¾ç„¶ï¼Œè¿™æ ·çš„æ—¶é—´å¤æ‚åº¦å¤ªé«˜ï¼Œè‚¯å®šä¼šçˆ†æ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è«é˜Ÿç®—æ³•</p><hr><p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆ$curl$ï¼Œ$curr$ï¼Œæ¯æ¬¡è¯¢é—®æˆ‘ä»¬é€šè¿‡ç§»åŠ¨è¿™ä¸¤ä¸ªæŒ‡é’ˆæ¥æ¡†å®šåŒºé—´ï¼Œ</p><p><img src="https://upload-images.jianshu.io/upload_images/13056869-cf00293220a16a59.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p>å‡è®¾ä¸€å¼€å§‹ $curl$ æŒ‡å‘ $4$ ï¼Œ$curr$ æŒ‡å‘ $6$ï¼Œ</p><p>ä¸‹ä¸€ä¸ªè¯¢é—®è¦æ±‚åŒºé—´ $3$ ~ $5$ï¼Œé‚£ä¹ˆæˆ‘ä»¬ $curlâ€“$ ï¼Œé¡ºå¸¦æ’å…¥ $3$ ï¼Œ$currâ€“$ï¼Œé¡ºå¸¦åˆ å» $6$ï¼Œ</p><p><strong>æ³¨æ„å½“å‰çš„å…ˆåé¡ºåº</strong><br>$curlâ€“$ è¦æ±‚å…ˆå‡ååŠ å…¥ï¼Œè€Œ $currâ€“$ è¦æ±‚å…ˆåˆ å»å†å‡</p><p>åŒç†ï¼Œ$curl++$ è¦æ±‚å…ˆåˆ å»å†åŠ ï¼Œè€Œ $curr++$ è¦æ±‚å…ˆåŠ å†åŠ å…¥</p><p>æˆ‘ä»¬å¯ä»¥å†™å‡ºè¿™ä¸€éƒ¨åˆ†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> lsans;<span class="comment">//è¡¨ç¤ºè¯¥åŒºé—´çš„ç­”æ¡ˆ</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> pos)</span></span>&#123;lsans+=(++cnt[a[pos]]==<span class="number">1</span>);&#125;<span class="comment">//åŠ å…¥</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> pos)</span></span>&#123;lsans-=(--cnt[a[pos]]==<span class="number">0</span>);&#125;<span class="comment">//åˆ å»</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(curr&lt;rr) add(++curr);<span class="comment">//å˜åŒ–èŒƒå›´</span></span><br><span class="line"><span class="keyword">while</span>(curr&gt;rr) del(curr--);</span><br><span class="line"><span class="keyword">while</span>(curl&gt;ll) add(--curl);</span><br><span class="line"><span class="keyword">while</span>(curl&lt;ll) del(curl++);</span><br></pre></td></tr></table></figure><h1 id="è«é˜Ÿçš„ä¼˜åŒ–"><a href="#è«é˜Ÿçš„ä¼˜åŒ–" class="headerlink" title="è«é˜Ÿçš„ä¼˜åŒ–"></a>è«é˜Ÿçš„ä¼˜åŒ–</h1><p>æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å‘ç°ï¼Œå¦‚æœé¢å¯¹ç‰¹åˆ«è®¾è®¡çš„æ•°æ®ï¼Œä¸Šé¢çš„æ—¶é—´å¤æ‚åº¦ä»ç„¶å¾ˆé«˜</p><p>ä¸¾ä¸ªæ —å­ï¼Œæœ‰6ä¸ªè¯¢é—®å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(1, 100)  (2, 2)  (3, 99)  (4, 4)  (5, 102)  (6, 7)</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬å¦‚æœç›´æ¥æŒ‰å·¦ç«¯ç‚¹ä¸Šå‡æ’åºï¼Œ</p><p>ç”¨ä¸Šè¿°æ–¹æ³•å¤„ç†æ—¶ï¼Œå·¦ç«¯ç‚¹ä¼šç§»åŠ¨$6$æ¬¡ï¼Œå³ç«¯ç‚¹ä¼šç§»åŠ¨ç§»åŠ¨$98+97+95+98+95=483$æ¬¡ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å…ˆæŒ‰å·¦ç«¯ç‚¹ä¸Šå‡æ’åºï¼Œå¦‚æœå·¦ç«¯ç‚¹æ‰€åœ¨çš„å—ç›¸åŒï¼Œå†åœ¨å—å†…æŒ‰å³ç«¯ç‚¹ä¸Šå‡æ’åºï¼Œå¾—åˆ°ç»“æœå°±åƒè¿™æ ·<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(2, 2)  (4, 4)  (6, 7)  (5, 102)  (3, 99)  (1, 100)</span><br></pre></td></tr></table></figure></p><p>å·¦ç«¯ç‚¹ç§»åŠ¨æ¬¡æ•°ä¸º$2+2+1+2+2=9$æ¬¡ï¼Œæ¯”åŸæ¥ç¨å¤šã€‚å³ç«¯ç‚¹ç§»åŠ¨æ¬¡æ•°ä¸º$2+3+95+3+1=104$ï¼Œå³ç«¯ç‚¹çš„ç§»åŠ¨æ¬¡æ•°å¤§å¤§é™ä½äº†ã€‚</p><h2 id="Code-ï¼š"><a href="#Code-ï¼š" class="headerlink" title="$Code$ï¼š"></a>$Code$ï¼š</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ques</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l , r , id ;</span><br><span class="line">&#125;que[<span class="number">100005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> ques &amp;a,<span class="keyword">const</span> ques &amp;b)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (a.l/blo==b.l/blo)?a.r&lt;b.r:a.l&lt;b.l;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æœ€ç»ˆçš„ä»£ç "><a href="#æœ€ç»ˆçš„ä»£ç " class="headerlink" title="æœ€ç»ˆçš„ä»£ç "></a>æœ€ç»ˆçš„ä»£ç </h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sync_with_stdio(false)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> s=<span class="number">0</span>,w=<span class="number">1</span>;</span><br><span class="line">   <span class="keyword">char</span> ch=getchar();</span><br><span class="line">   <span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)w=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">   <span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) s=s*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">   <span class="keyword">return</span> s*w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ques</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l , r , id ;</span><br><span class="line">&#125;que[<span class="number">100005</span>];</span><br><span class="line"><span class="keyword">int</span> n,m, blo,lsans;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> ques &amp;a,<span class="keyword">const</span> ques &amp;b)</span> </span>&#123;<span class="keyword">return</span> (a.l/blo==b.l/blo)?a.r&lt;b.r:a.l&lt;b.l;&#125;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">100005</span>],cnt[<span class="number">1000005</span>],ans[<span class="number">100005</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> pos)</span></span>&#123;lsans+=(++cnt[a[pos]]==<span class="number">1</span>);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> pos)</span></span>&#123;lsans-=(--cnt[a[pos]]==<span class="number">0</span>);&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n=read();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) a[i]=read();</span><br><span class="line">    m=read();blo=<span class="built_in">sqrt</span>(m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        que[i].l=read(),que[i].r=read();</span><br><span class="line">        que[i].id=i;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(que+<span class="number">1</span>,que+m+<span class="number">1</span>,cmp);</span><br><span class="line">    <span class="keyword">int</span> curl=<span class="number">0</span>,curr=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> ll=que[i].l,rr=que[i].r,idd=que[i].id;</span><br><span class="line">        <span class="keyword">while</span>(curr&lt;rr) add(++curr);</span><br><span class="line">        <span class="keyword">while</span>(curr&gt;rr) del(curr--);</span><br><span class="line">        <span class="keyword">while</span>(curl&gt;ll) add(--curl);</span><br><span class="line">        <span class="keyword">while</span>(curl&lt;ll) del(curl++);</span><br><span class="line">        ans[idd]=lsans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> åˆ†å— </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Segment Tree(ZKW)(PART TWO)</title>
      <link href="/posts/30408/"/>
      <url>/posts/30408/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æœ¬æ¥æƒ³çœ‹çœ‹ç½‘ä¸Šçš„è®²è§£çš„ï¼Œç»“æœå‘ç°éƒ½è®²å¾—ä¸æ¸…æ¥šï¼Œè¿˜æ˜¯è‡ªå·±å†™ä¸€ä¸ªå§</p></blockquote><hr><h1 id="æ™®é€šçº¿æ®µæ ‘ä¸ZKWçº¿æ®µæ ‘"><a href="#æ™®é€šçº¿æ®µæ ‘ä¸ZKWçº¿æ®µæ ‘" class="headerlink" title="æ™®é€šçº¿æ®µæ ‘ä¸ZKWçº¿æ®µæ ‘"></a>æ™®é€šçº¿æ®µæ ‘ä¸ZKWçº¿æ®µæ ‘</h1><blockquote><ul><li><strong>æ™®é€šçº¿æ®µæ ‘</strong>é€šè¿‡é€’å½’å»ºæ ‘ï¼Œå› è€Œå…¶å¸¸æ•°ç›¸å¯¹è¾ƒå¤§</li><li><strong>æ™®é€šçº¿æ®µæ ‘</strong>ä»£ç é•¿ï¼Œç›¸å¯¹è¾ƒå¤æ‚</li><li><strong>ZKWçº¿æ®µæ ‘</strong>é€šè¿‡å¾ªç¯å»ºæ ‘ï¼Œç›¸å¯¹å¸¸æ•°å°</li><li><strong>ZKWçº¿æ®µæ ‘</strong>ä»£ç çŸ­ï¼Œæ˜“ç†è§£</li></ul></blockquote><a id="more"></a><h1 id="ZKWçº¿æ®µæ ‘-Â·-æ— å·®åˆ†å¼±åŒ–ç‰ˆ"><a href="#ZKWçº¿æ®µæ ‘-Â·-æ— å·®åˆ†å¼±åŒ–ç‰ˆ" class="headerlink" title="ZKWçº¿æ®µæ ‘ Â· æ— å·®åˆ†å¼±åŒ–ç‰ˆ"></a>ZKWçº¿æ®µæ ‘ Â· æ— å·®åˆ†å¼±åŒ–ç‰ˆ</h1><p>çº¿æ®µæ ‘æ˜¯ä¸€ç§å †å¼å‚¨å­˜ç»“æ„ï¼Œ<br>è§‚å¯Ÿå…¶èŠ‚ç‚¹ç¼–å·</p><p><img src="https://upload-images.jianshu.io/upload_images/13056869-91458b9150248d4f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p>å°†å…¶è½¬åŒ–æˆäºŒè¿›åˆ¶</p><p><img src="https://upload-images.jianshu.io/upload_images/13056869-822d1fc74b118836.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p>è§„å¾‹æ˜¯å¾ˆæ˜¾ç„¶çš„</p><blockquote><ul><li>ä¸€ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯è¿™ä¸ªæ•°å·¦ç§»1ï¼Œè¿™ä¸ªä½è¿ç®—å°±æ˜¯ä½ä½èˆå¼ƒï¼Œæ‰€æœ‰æ•°å­—å·¦ç§»ä¸€ä½</li><li>ä¸€ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹æ˜¯è¿™ä¸ªæ•°å³ç§»1ï¼Œæ˜¯å·¦èŠ‚ç‚¹ï¼Œå³ç§»1 +1æ˜¯å³èŠ‚ç‚¹</li><li>åŒä¸€å±‚çš„èŠ‚ç‚¹æ˜¯ä¾æ¬¡é€’å¢çš„ï¼Œç¬¬$n$å±‚æœ‰$2^{n-1}$ä¸ªèŠ‚ç‚¹</li><li>æœ€åä¸€å±‚æœ‰å¤šå°‘èŠ‚ç‚¹ï¼Œå€¼åŸŸå°±æ˜¯å¤šå°‘(è¿™ä¸ªå¾ˆé‡è¦)</li></ul></blockquote><p>æœ‰äº†è¿™äº›è§„å¾‹å°±å¯ä»¥å¼€å§‹ç€æ‰‹å»ºæ ‘äº†</p><p>è‹¥æ ‘çš„å±‚æ•°ä¸º $m$ ï¼Œåˆ™æœ€åä¸€å±‚çš„èŠ‚ç‚¹æ•° $cnt$ æ»¡è¶³ $cnt = 2^{m-1}$</p><p>è‹¥æ•°çš„ä¸ªæ•°ä¸º $x$ ï¼Œåˆ™æ•°çš„ä¸ªæ•°xæ»¡è¶³ $\frac {cnt}{2} &lt; x &lt;= cnt$<br>ï¼ˆå¤§äº$x$å°äº$cnt$çš„éƒ¨åˆ†æ— è§†ï¼‰</p><p>åº•å±‚èŠ‚ç‚¹åºå·ä» $cnt$ å¼€å§‹ï¼Œä¸€ç›´åˆ° $cnt+n-1$ ç»“æŸï¼Œç¬¬ $p$ ä¸ªæ•°ç¼–å·ä¸º $cnt+p-1$</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆç®—å‡ºè¿™ä¸ª $cnt$ çš„æœ€å°å€¼<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(cnt=<span class="number">1</span>;cnt&lt;x;cnt&lt;&lt;=<span class="number">1</span>);<span class="comment">//è¿™é‡Œæ²¡æœ‰ç­‰å·ï¼Œä»¥ä¿è¯cntæœ€å°</span></span><br></pre></td></tr></table></figure></p><h2 id="å»ºæ ‘"><a href="#å»ºæ ‘" class="headerlink" title="å»ºæ ‘"></a>å»ºæ ‘</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,a[<span class="number">10005</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line">&#125;Tree[<span class="number">10005</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(cnt=<span class="number">1</span>;cnt&lt;x;cnt&lt;&lt;=<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=cnt;i&lt;cnt+n;i++) Tree[i].num=read();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä»…ä»…æ˜¯å¯¹å¶å­èŠ‚ç‚¹è¿›è¡Œæ“ä½œï¼Œä¹‹åï¼Œæˆ‘ä»¬è¦ä¾æ¬¡æ›´æ–°çˆ¶èŠ‚ç‚¹<br>ç”±äºæ˜¯è‡ªä¸‹å¾€ä¸Šæ›´æ–°ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åº”å½“ä» $cnt-1$ å¼€å§‹ï¼Œä¸€ç›´åˆ° $1$<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=cnt<span class="number">-1</span>;i&gt;=<span class="number">1</span>;i--)</span><br><span class="line">    Tree[i].num=Tree[i&lt;&lt;<span class="number">1</span>].num+Tree[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].num;</span><br></pre></td></tr></table></figure></p><p>æœ€åçš„å»ºæ ‘ä»£ç <br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(cnt=<span class="number">1</span>;cnt&lt;x;cnt&lt;&lt;=<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=cnt;i&lt;cnt+n;i++) Tree[i].num=read();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=cnt<span class="number">-1</span>;i&gt;=<span class="number">1</span>;i--) Tree[i].num=Tree[i&lt;&lt;<span class="number">1</span>].num+Tree[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].num;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å•ç‚¹æ“ä½œ"><a href="#å•ç‚¹æ“ä½œ" class="headerlink" title="å•ç‚¹æ“ä½œ"></a>å•ç‚¹æ“ä½œ</h2><p>ç›´æ¥ä¿®æ”¹<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[cnt+x<span class="number">-1</span>].num+=k;</span><br><span class="line">    <span class="keyword">while</span>(x) Tree[x&gt;&gt;=<span class="number">1</span>].num=Tree[x&lt;&lt;<span class="number">1</span>].num+Tree[x&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].num;<span class="comment">//æ›´æ–°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å•ç‚¹æŸ¥è¯¢"><a href="#å•ç‚¹æŸ¥è¯¢" class="headerlink" title="å•ç‚¹æŸ¥è¯¢"></a>å•ç‚¹æŸ¥è¯¢</h2><p>ç›´æ¥ä¿®æ”¹<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">askpot</span><span class="params">(<span class="keyword">int</span> pos)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> Tree[cnt+pos<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><h1 id="ZKWçº¿æ®µæ ‘-Â·-å·®åˆ†ç‰ˆ"><a href="#ZKWçº¿æ®µæ ‘-Â·-å·®åˆ†ç‰ˆ" class="headerlink" title="ZKWçº¿æ®µæ ‘ Â· å·®åˆ†ç‰ˆ"></a>ZKWçº¿æ®µæ ‘ Â· å·®åˆ†ç‰ˆ</h1><h2 id="å»ºæ ‘-1"><a href="#å»ºæ ‘-1" class="headerlink" title="å»ºæ ‘"></a>å»ºæ ‘</h2><p>æˆ‘ä»¬å‘ç°ï¼Œä¸Šé¢çš„æ–¹æ³•å¯¹äºåŒºé—´æ“ä½œæ—¶é—´å¤æ‚åº¦ä¼šå¾ˆé«˜ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·®åˆ†æ€æƒ³æ¥è¿›è¡Œä¼˜åŒ–</p><p>æ­¤æ—¶ï¼Œçº¿æ®µæ ‘èŠ‚ç‚¹å­˜çš„å€¼æ˜¯ä»–å’Œçˆ¶èŠ‚ç‚¹çš„å·®å€¼<br>æˆ‘ä»¬å†æ¥å†™ä¸€ä¸‹å·®åˆ†ç‰ˆçš„build<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (cnt = <span class="number">1</span>; cnt &lt; x; cnt &lt;&lt;= <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = cnt; i &lt; cnt + n; i++) Tree[i].num = read();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = cnt - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        Tree[i].num = min(Tree[i &lt;&lt; <span class="number">1</span>].num, Tree[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">        Tree[i &lt;&lt; <span class="number">1</span>].num -= Tree[i];</span><br><span class="line">        Tree[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].num -= Tree[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å•ç‚¹æŸ¥è¯¢-1"><a href="#å•ç‚¹æŸ¥è¯¢-1" class="headerlink" title="å•ç‚¹æŸ¥è¯¢"></a>å•ç‚¹æŸ¥è¯¢</h2><p>ç”±äºå·®åˆ†çš„æ€§è´¨<br>åªéœ€ä¾æ¬¡å‘ä¸Šç´¯åŠ å°±å¯ä»¥æ±‚å‡ºæ”¹ç‚¹çš„å€¼<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">askpot</span><span class="params">(<span class="keyword">int</span> pos)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum=<span class="number">0</span>,x=cnt+pos<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(x) sum+=Tree[x].num,x&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="åŒºé—´æŸ¥è¯¢"><a href="#åŒºé—´æŸ¥è¯¢" class="headerlink" title="åŒºé—´æŸ¥è¯¢"></a>åŒºé—´æŸ¥è¯¢</h2> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">askRange</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> æ¨¡ç‰ˆ </tag>
            
            <tag> ZKWçº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Segment Tree (PART ONE)</title>
      <link href="/posts/7674/"/>
      <url>/posts/7674/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h1><blockquote><p>çº¿æ®µæ ‘ï¼Œç±»ä¼¼åŒºé—´æ ‘ï¼Œå®ƒåœ¨å„ä¸ªèŠ‚ç‚¹ä¿å­˜ä¸€æ¡çº¿æ®µï¼ˆæ•°ç»„ä¸­çš„ä¸€æ®µå­æ•°ç»„ï¼‰ï¼Œä¸»è¦ç”¨äºé«˜æ•ˆè§£å†³è¿ç»­åŒºé—´çš„åŠ¨æ€æŸ¥è¯¢é—®é¢˜ï¼Œç”±äºäºŒå‰ç»“æ„çš„ç‰¹æ€§ï¼Œå®ƒåŸºæœ¬èƒ½ä¿æŒæ¯ä¸ªæ“ä½œçš„å¤æ‚åº¦ä¸º$O(logn)$ã€‚</p></blockquote><h1 id="æ“ä½œ"><a href="#æ“ä½œ" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h1><p>ä¸‹é¢æˆ‘ä»¬ä»ä¸€ä¸ªç»å…¸çš„ä¾‹å­æ¥äº†è§£çº¿æ®µæ ‘<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä»æ•°ç»„arr[<span class="number">0.</span>..n<span class="number">-1</span>]ä¸­æŸ¥æ‰¾æŸä¸ªæ•°ç»„æŸä¸ªåŒºé—´å†…çš„æœ€å°å€¼ï¼Œ</span><br><span class="line">å…¶ä¸­æ•°ç»„å¤§å°å›ºå®šï¼Œä½†æ˜¯æ•°ç»„ä¸­çš„å…ƒç´ çš„å€¼å¯ä»¥éšæ—¶æ›´æ–°ã€‚</span><br></pre></td></tr></table></figure></p><a id="more"></a><p>æˆ‘ä»¬å¯ä»¥ç”¨çº¿æ®µæ ‘æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼šé¢„å¤„ç†è€—æ—¶$O(n)$ï¼ŒæŸ¥è¯¢ã€æ›´æ–°æ“ä½œ$O(logn)$ï¼Œéœ€è¦é¢å¤–çš„ç©ºé—´$O(n)$ã€‚æ ¹æ®è¿™ä¸ªé—®é¢˜æˆ‘ä»¬æ„é€ å¦‚ä¸‹çš„äºŒå‰æ ‘</p><ul><li>å¶å­èŠ‚ç‚¹æ˜¯åŸå§‹ç»„æ•°arrä¸­çš„å…ƒç´ </li><li>éå¶å­èŠ‚ç‚¹ä»£è¡¨å®ƒçš„æ‰€æœ‰å­å­™å¶å­èŠ‚ç‚¹æ‰€åœ¨åŒºé—´çš„æœ€å°å€¼<br>ä¾‹å¦‚å¯¹äºæ•°ç»„[2, 5, 1, 4, 9, 3]å¯ä»¥æ„é€ å¦‚ä¸‹çš„äºŒå‰æ ‘ï¼ˆèƒŒæ™¯ä¸ºç™½è‰²è¡¨ç¤ºå¶å­èŠ‚ç‚¹ï¼Œéå¶å­èŠ‚ç‚¹çš„å€¼æ˜¯å…¶å¯¹åº”æ•°ç»„åŒºé—´å†…çš„æœ€å°å€¼ï¼Œä¾‹å¦‚æ ¹èŠ‚ç‚¹è¡¨ç¤ºæ•°ç»„åŒºé—´arr[0â€¦5]å†…çš„æœ€å°å€¼æ˜¯1ï¼‰ï¼š<br><img src="https://images0.cnblogs.com/blog/517264/201312/01204058-426dce8b8a05491b91edeba9ec2e4112.jpg" alt=""></li></ul><p>ç”±äºçº¿æ®µæ ‘çš„çˆ¶èŠ‚ç‚¹åŒºé—´æ˜¯å¹³å‡åˆ†å‰²åˆ°å·¦å³å­æ ‘ï¼Œå› æ­¤çº¿æ®µæ ‘æ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œå¯¹äºåŒ…å«$n$ä¸ªå¶å­èŠ‚ç‚¹çš„å®Œå…¨äºŒå‰æ ‘ï¼Œå®ƒä¸€å®šæœ‰$n-1$ä¸ªéå¶èŠ‚ç‚¹ï¼Œæ€»å…±$2n-1$ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤å­˜å‚¨çº¿æ®µæ˜¯éœ€è¦çš„ç©ºé—´å¤æ‚åº¦æ˜¯$O(n)$</p><h1 id="åˆ›å»ºçº¿æ®µæ ‘"><a href="#åˆ›å»ºçº¿æ®µæ ‘" class="headerlink" title="åˆ›å»ºçº¿æ®µæ ‘"></a>åˆ›å»ºçº¿æ®µæ ‘</h1><h2 id="å­èŠ‚ç‚¹"><a href="#å­èŠ‚ç‚¹" class="headerlink" title="å­èŠ‚ç‚¹"></a>å­èŠ‚ç‚¹</h2><p>æ ¹æ®çº¿æ®µæ ‘çš„æ€§è´¨ï¼ˆå®Œå…¨äºŒå‰æ ‘ï¼‰ï¼Œåªéœ€çŸ¥é“çˆ¶èŠ‚ç‚¹ï¼Œå°±å¯ä»¥è®¡ç®—å‡ºå­èŠ‚ç‚¹çš„åºå·<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">getLeftNum</span><span class="params">(LL p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p&lt;&lt;<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">getRightNum</span><span class="params">(LL p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="æ ‘çš„å­˜æ”¾å’ŒèŠ‚ç‚¹ä¿¡æ¯"><a href="#æ ‘çš„å­˜æ”¾å’ŒèŠ‚ç‚¹ä¿¡æ¯" class="headerlink" title="æ ‘çš„å­˜æ”¾å’ŒèŠ‚ç‚¹ä¿¡æ¯"></a>æ ‘çš„å­˜æ”¾å’ŒèŠ‚ç‚¹ä¿¡æ¯</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­æˆ‘ä»¬éœ€è¦ç»´æŠ¤çš„å¯¹è±¡ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ª<strong>å€¼</strong>ï¼Œä¹Ÿå¯ä»¥æ˜¯<strong>é¢œè‰²</strong>ï¼Œ<strong>çŠ¶æ€</strong>ç­‰<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> val;<span class="comment">//å¯ä»¥æ·»åŠ col,statusï¼Œlztag</span></span><br><span class="line">&#125;Tree[N];</span><br></pre></td></tr></table></figure></p><h2 id="å»ºæ ‘æ“ä½œ"><a href="#å»ºæ ‘æ“ä½œ" class="headerlink" title="å»ºæ ‘æ“ä½œ"></a>å»ºæ ‘æ“ä½œ</h2><p>æˆ‘ä»¬ä½¿ç”¨é€’å½’æ“ä½œæ¥å»ºæ ‘</p><blockquote><ul><li>å½“å·¦ç«¯ç‚¹å’Œå³æ®µç‚¹ç›¸åŒæ—¶ï¼Œæ„å‘³ç€æ­¤æ—¶çš„$p$èŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹</li><li>äºŒåˆ†å½“å‰åŒºé—´ï¼Œé€’å½’å»ºæ ‘</li></ul></blockquote><p>æ³¨æ„ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªå°šæœªå‡ºç°çš„ä¸œè¥¿ï¼Œ$pushup$å‡½æ•°å’Œ$lztag$æ ‡è®°</p><p>$pushup$å‡½æ•°ç”¨äºä»å­èŠ‚ç‚¹å‘ä¸Šä¾æ¬¡æ›´æ–°çˆ¶èŠ‚ç‚¹çš„å€¼<br>è€Œ$lztag$æ˜¯ç”¨äºåŒºé—´ä¿®æ”¹çš„æ‡’æ ‡è®°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">buildTree</span><span class="params">(LL p,LL l,LL r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    lztag[p]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r) &#123;Tree[p]=a[l];<span class="keyword">return</span> ;&#125;</span><br><span class="line">    LL mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    buildTree(getLeftNum(p),l,mid);</span><br><span class="line">    buildTree(getRightNum(p),mid+<span class="number">1</span>,r);</span><br><span class="line">    pushup(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="pushup-æ“ä½œ"><a href="#pushup-æ“ä½œ" class="headerlink" title="pushup æ“ä½œ"></a>pushup æ“ä½œ</h2><p>$pushup$èµ·åˆ°æ›´æ–°çš„ä½œç”¨ï¼Œå¯¹äºä¸åŒçš„éœ€æ±‚ï¼Œæœ‰ä¸åŒçš„$pushup$æ“ä½œ</p><p>å¯¹äºæ±‚å’Œï¼Œå¯ä»¥è¿™ä¹ˆå†™<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(LL p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[p]=Tree[getLeftNum(p)]+Tree[getRightNum(p)]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è€Œå¯¹äºæ±‚ æœ€å¤§å€¼/æœ€å°å€¼ ï¼Œåˆ™å¯ä»¥è¿™ä¹ˆå†™<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">put_up</span><span class="params">(LL p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[p]=max(Tree[getLeftNum(p)],Tree[getRightNum(p)]);</span><br><span class="line">    <span class="comment">//Tree[p]=min(Tree[getLeftNum(p)],Tree[getRightNum(p)]);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="æ›´æ–°æ“ä½œ"><a href="#æ›´æ–°æ“ä½œ" class="headerlink" title="æ›´æ–°æ“ä½œ"></a>æ›´æ–°æ“ä½œ</h2><p>æ›´æ–°æ“ä½œå¯ä»¥åˆ†ä¸ºä¸¤ç§</p><ul><li>å•ç‚¹æ“ä½œ</li><li>åŒºé—´æ“ä½œ</li></ul><h3 id="å•ç‚¹æ“ä½œï¼ˆupdataPotï¼‰"><a href="#å•ç‚¹æ“ä½œï¼ˆupdataPotï¼‰" class="headerlink" title="å•ç‚¹æ“ä½œï¼ˆupdataPotï¼‰"></a>å•ç‚¹æ“ä½œï¼ˆupdataPotï¼‰</h3><p>æ˜ç¡®å˜é‡åï¼š</p><ol><li>ï¼ˆl ~ rï¼‰ â€”â€”  å¯æ”¯é…åŒºé—´</li><li>ï¼ˆnedChangeL ~ nedChangeRï¼‰ â€”â€”  éœ€æ“ä½œåŒºé—´</li><li>mid â€”â€” å¯æ”¯é…åŒºé—´ä¸­ç‚¹</li></ol><p>æ³¨ :</p><blockquote><ul><li>å½“$mid$ä¸å°äº$nedChangeL$æ—¶ ä»£è¡¨å» $l$ ~ $mid$ æ›´æ–°æ˜¯æœ‰æ„ä¹‰çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬é€‰æ‹©æ›´æ–°è¯¥åŒºé—´</li><li>$mid$å’Œ$nedChangeR$åŒç†</li></ul></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updataPot</span><span class="params">(LL nedChangeL,LL nedChangeR,LL l,LL r,LL p,LL num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) &#123;Tree[p]=num;<span class="keyword">return</span> ;&#125;</span><br><span class="line">    LL mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(nedChangeL&lt;=mid) updata(nedChangeL,nedChangeR,l,mid,getLeftNum(p),num);</span><br><span class="line">    <span class="keyword">if</span>(nedChangeR&gt;mid) updata(nedChangeL,nedChangeR,mid+<span class="number">1</span>,r,getRightNum(p),num);</span><br><span class="line">    put_up(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŒºé—´æ“ä½œï¼ˆupdataIntervalï¼‰"><a href="#åŒºé—´æ“ä½œï¼ˆupdataIntervalï¼‰" class="headerlink" title="åŒºé—´æ“ä½œï¼ˆupdataIntervalï¼‰"></a>åŒºé—´æ“ä½œï¼ˆupdataIntervalï¼‰</h3><p>#åŒºé—´æ“ä½œéœ€è¦å¼•å…¥ä¸€ä¸ªæ¦‚å¿µ </p><blockquote><p>$lazytag$ :<br>$lazytag$æ ‡æ³¨çš„æ˜¯çº¿æ®µæ ‘ä¸­æ¯ä¸ªæ ‘çš„å˜åŒ–é‡ï¼Œå³ $\Delta$ </p><p>$lazytag$ æ“ä½œæ—¶æ­£å¦‚å…¶åï¼Œåªå¯¹ç›®å‰çŠ¶æ€æ‰“ä¸Šæ ‡è®°ï¼Œç­‰åˆ°æ›´æ–°æ—¶ï¼Œæ‰å‘ä¸‹ä¼ é€’<br>å› æ­¤ï¼Œå¼•å…¥å¦ä¸€ä¸ªå‡½æ•°$pushdown$ï¼Œç”¨äºæ›´æ–°å…¶å­èŠ‚ç‚¹çš„$lazytag$å’Œæœ¬èŠ‚ç‚¹çš„æ•°å€¼</p></blockquote><p>æ¥ä¸‹æ¥ç»™å‡º$pushdown$çš„ä»£ç <br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">updataSum</span><span class="params">(LL p,LL l,LL r,LL num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    lztag[p]=lztag[p]+num;</span><br><span class="line">    Tree[p]+=num*(r-l+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">put_down</span><span class="params">(LL p,LL l,LL r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    updataSum(getLeftNum(p),l,mid,lztag[p]);</span><br><span class="line">    updataSum(getRightNum(p),mid+<span class="number">1</span>,r,lztag[p]);</span><br><span class="line">    lztag[p]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æœ‰äº†$pushdown$ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å®Œæˆ$updata$æ“ä½œ<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updataInterval</span><span class="params">(LL needChangeL,LL needChangeR,LL l,LL r,LL p,LL num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(needChangeL&lt;=l&amp;&amp;r&lt;=needChangeR) &#123;updataSum(p,l,r,num);<span class="keyword">return</span> ;&#125;</span><br><span class="line">    put_down(p,l,r);</span><br><span class="line">    LL mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(needChangeL&lt;=mid) updata(needChangeL,needChangeR,l,mid,getLeftNum(p),num);</span><br><span class="line">    <span class="keyword">if</span>(needChangeR&gt;mid) updata(needChangeL,needChangeR,mid+<span class="number">1</span>,r,getRightNum(p),num);</span><br><span class="line">    put_up(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="åŒºé—´æ±‚å€¼ï¼ˆqueryï¼‰"><a href="#åŒºé—´æ±‚å€¼ï¼ˆqueryï¼‰" class="headerlink" title="åŒºé—´æ±‚å€¼ï¼ˆqueryï¼‰"></a>åŒºé—´æ±‚å€¼ï¼ˆqueryï¼‰</h2><p>åŒºé—´æ±‚å€¼æ—¶ï¼Œæˆ‘ä»¬è¿›è¡Œäº†è¯¢é—®ï¼Œè€Œå› ä¸º$lazytag$çš„åŸå› ï¼Œåœ¨æ±‚å€¼ä¹‹å‰ï¼Œéœ€å…ˆè¿›è¡Œ$pushdown$æ“ä½œ<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">getSum</span><span class="params">(LL qx,LL qy,LL l,LL r,LL p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(qx&lt;=l&amp;&amp;r&lt;=qy)<span class="keyword">return</span> Tree[p];</span><br><span class="line">    LL mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    put_down(p,l,r);</span><br><span class="line">    <span class="keyword">if</span>(qx&lt;=mid)sum+=getSum(qx,qy,l,mid,getLeftNum(p));</span><br><span class="line">    <span class="keyword">if</span>(qy&gt;mid) sum+=getSum(qx,qy,mid+<span class="number">1</span>,r,getRightNum(p));</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="END"><a href="#END" class="headerlink" title="END"></a>END</h1>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> æ¨¡ç‰ˆ </tag>
            
            <tag> æ™®é€šçº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æœ€å°ç”Ÿæˆæ ‘</title>
      <link href="/posts/57313/"/>
      <url>/posts/57313/</url>
      
        <content type="html"><![CDATA[<blockquote><h1 id="æœ€å°ç”Ÿæˆæ ‘æœ‰ä¸¤ç§ç®—æ³•"><a href="#æœ€å°ç”Ÿæˆæ ‘æœ‰ä¸¤ç§ç®—æ³•" class="headerlink" title="æœ€å°ç”Ÿæˆæ ‘æœ‰ä¸¤ç§ç®—æ³•"></a>æœ€å°ç”Ÿæˆæ ‘æœ‰ä¸¤ç§ç®—æ³•</h1><h2 id="Prim-amp-Kruskal"><a href="#Prim-amp-Kruskal" class="headerlink" title="Prim &amp; Kruskal"></a>Prim &amp; Kruskal</h2></blockquote><a id="more"></a><h3 id="1-Prim"><a href="#1-Prim" class="headerlink" title="1. Prim"></a>1. Prim</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 0x7fffffff</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 5005</span></span><br><span class="line"><span class="keyword">int</span> cost[maxn][maxn],minn,n,m,v2[maxn],tot=<span class="number">1</span>,now,ans;</span><br><span class="line"><span class="keyword">bool</span> v1[maxn];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">getcost</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=n; j++) &#123;</span><br><span class="line">            cost[i][j]=inf;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,u,v,w; i&lt;=m; i++) &#123;</span><br><span class="line">           <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;u,&amp;v,&amp;w);</span><br><span class="line">                <span class="keyword">if</span>(cost[u][v]&gt;w) &#123;</span><br><span class="line">                    cost[u][v]=cost[v][u]=w;</span><br><span class="line">                &#125;</span><br><span class="line">    &#125;<span class="comment">//åˆå§‹åŒ–costæ•°ç»„</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">        v2[i]=cost[<span class="number">1</span>][i];</span><br><span class="line">    &#125;</span><br><span class="line">    v1[<span class="number">1</span>]=<span class="number">1</span>;<span class="comment">//æ‰¾å‡ºä¸1èŠ‚ç‚¹ç›¸è¿çš„è¾¹å¹¶è¿›è¡Œæ ‡è®°</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">prim</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(tot&lt;n) &#123; <span class="comment">//æœ€å°ç”Ÿæˆæ ‘çš„æ¦‚å¿µ</span></span><br><span class="line">        minn=inf;</span><br><span class="line">        tot++;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!v1[i]&amp;&amp;v2[i]&lt;minn) &#123;</span><br><span class="line">                minn=v2[i];</span><br><span class="line">                now=i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="comment">//æ‰¾å‡ºæœ€å°è¾¹</span></span><br><span class="line"></span><br><span class="line">        ans+=minn;<span class="comment">//æ›´æ–°ç­”æ¡ˆ</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(v2[i]&gt;cost[now][i]&amp;&amp;!v1[i]) &#123;</span><br><span class="line">                v2[i]=cost[now][i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        v1[now]=<span class="number">1</span>;<span class="comment">//åœ¨æ‰¾å‡ºä¸nowèŠ‚ç‚¹ç›¸è¿çš„è¾¹å¹¶è¿›è¡Œæ ‡è®°</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    getcost();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,prim());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//ä¸»å‡½æ•°ä¸è§£é‡Š</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-Kruskal"><a href="#2-Kruskal" class="headerlink" title="2. Kruskal"></a>2. Kruskal</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(a,b) return a&gt;b?a:b </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span><span class="keyword">int</span> pointA,pointB,w;&#125;edge[<span class="number">200005</span>];</span><br><span class="line"><span class="keyword">int</span> father[<span class="number">5005</span>],n,m,ans,eu,ev,cnt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Edge a,Edge b)</span></span>&#123;<span class="keyword">return</span> a.w&lt;b.w;&#125;<span class="comment">//å¿«æ’çš„ä¾æ®</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">findfather</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(x!=father[x]) x=father[x]=father[father[x]];</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;<span class="comment">//å¹¶æŸ¥é›†æ¨¡æ¿ï¼Œç”¨whileå¾ªç¯æ¯”é€’å½’ç‰ˆå¿«</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">kruskal</span><span class="params">()</span></span>&#123;</span><br><span class="line">    sort(edge+<span class="number">1</span>,edge+m+<span class="number">1</span>,cmp);<span class="comment">//å°†è¾¹çš„æƒå€¼æ’åº</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">        eu=findfather(edge[i].pointA), ev=findfather(edge[i].pointB);</span><br><span class="line">        <span class="keyword">if</span>(eu==ev) <span class="keyword">continue</span>;<span class="comment">//è‹¥å‡ºç°ç¯ï¼Œåˆ™continue</span></span><br><span class="line">        ans+=edge[i].w;<span class="comment">//æ›´æ–°ç­”æ¡ˆ</span></span><br><span class="line">        father[ev]=eu; cnt++;</span><br><span class="line">        <span class="keyword">if</span>(cnt==n<span class="number">-1</span>) <span class="keyword">break</span>;<span class="comment">//å¾ªç¯ç»“æŸæ¡ä»¶</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) father[i]=i;<span class="comment">//åˆå§‹åŒ–å¹¶æŸ¥é›†</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;edge[i].pointA,&amp;edge[i].pointB,&amp;edge[i].w);</span><br><span class="line">    kruskal();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¨¡ç‰ˆ </tag>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ä½è¿ç®—</title>
      <link href="/posts/60366/"/>
      <url>/posts/60366/</url>
      
        <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/13056869-7a547f75361aceca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><a id="more"></a><h1 id="1-amp"><a href="#1-amp" class="headerlink" title="1.&amp;"></a>1.&amp;</h1><p>å¦‚æœä¸¤ä¸ªç›¸åº”çš„äºŒè¿›åˆ¶ä½éƒ½ä¸ºï¼‘ï¼Œåˆ™è¯¥ä½çš„ç»“æœå€¼ä¸º1ï¼›å¦åˆ™ä¸º0ã€‚</p><blockquote><p>æ³¨ï¼šä¸‹é¢éƒ½ç”¨8ä½çš„ unsigned char æ¥åšä¾‹å­ã€‚</p></blockquote><h4 id="amp-ç®€å•ä¸¾ä¾‹ï¼š"><a href="#amp-ç®€å•ä¸¾ä¾‹ï¼š" class="headerlink" title="&amp;ç®€å•ä¸¾ä¾‹ï¼š"></a>&amp;ç®€å•ä¸¾ä¾‹ï¼š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">11&amp;3  = 3</span><br><span class="line"></span><br><span class="line">    00001011</span><br><span class="line"></span><br><span class="line">&amp;   00000011</span><br><span class="line"></span><br><span class="line">=   00000011 </span><br><span class="line">=   3</span><br></pre></td></tr></table></figure><h4 id="amp-æ¯”è¾ƒå®ç”¨çš„ä¾‹å­ï¼š"><a href="#amp-æ¯”è¾ƒå®ç”¨çš„ä¾‹å­ï¼š" class="headerlink" title="&amp;æ¯”è¾ƒå®ç”¨çš„ä¾‹å­ï¼š"></a>&amp;æ¯”è¾ƒå®ç”¨çš„ä¾‹å­ï¼š</h4><p>æˆ‘ä»¬ç»å¸¸è¦ç”¨çš„æ˜¯å¦è¢«2æ•´é™¤ï¼Œä¸€èˆ¬éƒ½å†™æˆ   if(n % 2 == 0)</p><p>å¯ä»¥æ¢æˆ if((n&amp;1) == 0) </p><h1 id="2"><a href="#2" class="headerlink" title="2.|"></a>2.|</h1><p>å¦‚æœä¸¤ä¸ªç›¸åº”çš„äºŒè¿›åˆ¶ä½åªè¦æœ‰ä¸€ä¸ªæ˜¯1ï¼Œç»“æœå°±æ˜¯1ï¼›å¦åˆ™ä¸º0ã€‚</p><h3 id="ç®€å•ä¾‹å­ï¼š"><a href="#ç®€å•ä¾‹å­ï¼š" class="headerlink" title="| ç®€å•ä¾‹å­ï¼š"></a>| ç®€å•ä¾‹å­ï¼š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">11 | 3 = 11</span><br><span class="line"></span><br><span class="line">    00001011</span><br><span class="line"></span><br><span class="line">|   00000011</span><br><span class="line"></span><br><span class="line">=   00001011 </span><br><span class="line"></span><br><span class="line">=   11</span><br></pre></td></tr></table></figure><h3 id="æ¯”è¾ƒå®ç”¨çš„ä¾‹å­"><a href="#æ¯”è¾ƒå®ç”¨çš„ä¾‹å­" class="headerlink" title="| æ¯”è¾ƒå®ç”¨çš„ä¾‹å­"></a>| æ¯”è¾ƒå®ç”¨çš„ä¾‹å­</h3><p>å¯ä»¥ç”¨ä¸€ä¸ªunsigned int æ¥å­˜å‚¨å¤šä¸ªå¸ƒå°”å€¼ã€‚æ¯”å¦‚ä¸€ä¸ªæ–‡ä»¶æœ‰è¯»æƒé™ï¼Œå†™æƒé™ï¼Œæ‰§è¡Œæƒé™ã€‚çœ‹èµ·æ¥è¦è®°å½•3ä¸ªå¸ƒå°”å€¼ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªunsigned intä¹Ÿå¯ä»¥å®Œæˆä»»åŠ¡ã€‚</p><p>ä¸€ä¸ªæ•°ræ¥è¡¨ç¤ºè¯»æƒé™ï¼Œå®ƒåªæ›´æ”¹ä¸ªä½æ¥è®°å½•è¯»æƒé™çš„å¸ƒå°”å€¼ </p><p>00000001  (è¡¨ç¤ºæœ‰è¯»æƒé™) </p><p>00000000  (è¡¨ç¤ºæ²¡æœ‰è¯»æƒé™)</p><p>ä¸€ä¸ªæ•°wè¡¨ç¤ºå†™æƒé™ï¼Œå®ƒåªç”¨äºŒè¿›åˆ¶çš„å€’æ•°ç¬¬äºŒä½æ¥è®°å½•å¸ƒå°”å€¼</p><p>00000010 (è¡¨ç¤ºæœ‰å†™æƒé™)</p><p>00000000 (è¡¨ç¤ºæ²¡æœ‰å†™æƒé™)</p><p>ä¸€ä¸ªæ•°xè¡¨ç¤ºæ‰§è¡Œæƒé™ï¼Œå®ƒåªç”¨å€’æ•°ç¬¬ä¸‰ä½æ¥è®°å½•å¸ƒå°”å€¼</p><p>00000100 (è¡¨ç¤ºæœ‰æ‰§è¡Œæƒé™)</p><p>00000000 (è¡¨ç¤ºæ²¡æœ‰æ‰§è¡Œæƒé™)</p><p>é‚£ä¹ˆä¸€ä¸ªæ–‡ä»¶åŒæ—¶æ²¡æœ‰3ç§æƒé™å°±æ˜¯</p><p>~r | ~ w | ~ x å³ä¸º 00000000ï¼Œå°±æ˜¯0</p><p>åªæœ‰è¯»çš„æƒé™å°±æ˜¯</p><p>r | ~w | ~x å³ä¸º 00000001ï¼Œå°±æ˜¯1</p><p>åªæœ‰å†™çš„æƒé™å°±æ˜¯</p><p>~r | w | ~x å³ä¸º 00000010ï¼Œå°±æ˜¯2</p><p>ä¸€ä¸ªæ–‡ä»¶åŒæ—¶æœ‰3ç§æƒé™å°±æ˜¯</p><p>r | w | x å³ä¸º 00000111ï¼Œå°±æ˜¯7</p><h1 id="3-lt-lt-å‘å·¦ç§»ä½ç§»"><a href="#3-lt-lt-å‘å·¦ç§»ä½ç§»" class="headerlink" title="3. &lt;&lt; å‘å·¦ç§»ä½ç§»"></a>3. &lt;&lt; å‘å·¦ç§»ä½ç§»</h1><h3 id="lt-lt-ç®€å•ä¾‹å­-å‘å·¦ç§»ä¸€ä½ï¼Œå³è¾¹è‡ªåŠ¨è¡¥0"><a href="#lt-lt-ç®€å•ä¾‹å­-å‘å·¦ç§»ä¸€ä½ï¼Œå³è¾¹è‡ªåŠ¨è¡¥0" class="headerlink" title="&lt;&lt;ç®€å•ä¾‹å­(å‘å·¦ç§»ä¸€ä½ï¼Œå³è¾¹è‡ªåŠ¨è¡¥0)"></a>&lt;&lt;ç®€å•ä¾‹å­(å‘å·¦ç§»ä¸€ä½ï¼Œå³è¾¹è‡ªåŠ¨è¡¥0)</h3><p>11 &lt;&lt; 1 = 22</p><p> 00001011 &lt;&lt; 1</p><p> 00010110 = 22</p><p>ç›¸å½“äºäºŒè¿›åˆ¶çš„æ¯ä¸ªæ•°éƒ½å˜æˆå½“å‰å€¼çš„ä¸¤å€ï¼Œç»“æœå°±æ˜¯å˜æˆå½“å‰å€¼çš„ä¸¤å€ã€‚</p><p>n * 2 == (n &lt;&lt; 1)</p><h1 id="4-gt-gt-å‘å³ä½ç§»"><a href="#4-gt-gt-å‘å³ä½ç§»" class="headerlink" title="4. &gt;&gt; å‘å³ä½ç§»"></a>4. &gt;&gt; å‘å³ä½ç§»</h1><h3 id="gt-gt-ç®€å•ä¾‹å­-å‘å³ç§»ä¸€ä½ï¼Œå·¦è¾¹è‡ªåŠ¨è¡¥1"><a href="#gt-gt-ç®€å•ä¾‹å­-å‘å³ç§»ä¸€ä½ï¼Œå·¦è¾¹è‡ªåŠ¨è¡¥1" class="headerlink" title="&gt;&gt;ç®€å•ä¾‹å­(å‘å³ç§»ä¸€ä½ï¼Œå·¦è¾¹è‡ªåŠ¨è¡¥1)"></a>&gt;&gt;ç®€å•ä¾‹å­(å‘å³ç§»ä¸€ä½ï¼Œå·¦è¾¹è‡ªåŠ¨è¡¥1)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">11 &gt;&gt; 1 =  5</span><br><span class="line"></span><br><span class="line">00001011 &gt;&gt; 1</span><br><span class="line"></span><br><span class="line">00000101 = 5</span><br></pre></td></tr></table></figure><p>æ³¨æ„åˆ°æœ€åä¸€ä½çš„1è¢«å¹²æ‰äº†ã€‚</p><p>æ¯”è¾ƒå®ç”¨çš„ä¾‹å­æ˜¯:</p><p>int n = n / 2     ç­‰ä»·äº   int n = n &gt;&gt; 1  ç­‰ä»·äº int n &gt;&gt;= 1</p><h1 id="5-å¼‚æˆ–"><a href="#5-å¼‚æˆ–" class="headerlink" title="5. ^ å¼‚æˆ–"></a>5. ^ å¼‚æˆ–</h1><p>ä¸¤ä¸ªç›¸åŒçš„æ•°ä¼šå˜æˆ0ï¼Œåä¹‹æ˜¯1<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">11^3 = 8</span><br><span class="line"></span><br><span class="line">    00001011</span><br><span class="line"></span><br><span class="line">^   00000011</span><br><span class="line"></span><br><span class="line">=   00001000 = 8</span><br></pre></td></tr></table></figure></p><p>Given an array of integers, every element appearstwice except for one. Fnd that single one.</p><p>åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œæ‰€æœ‰æ•°å­—éƒ½å‡ºç°äº†ä¸¤æ¬¡ï¼Œåªæœ‰ä¸€ä¸ªæ²¡æœ‰</p><p>å¼‚æˆ–æ˜¯å«‰å¦’æˆåŒæˆå¯¹çš„ã€‚</p><p>æ¯”å¦‚ int t = {1,2,3,3,2,1,5} è¦æ‰¾åˆ°5ã€‚</p><p>ç”¨å¼‚æˆ–å°±å®Œç¾äº†ï¼Œæ‰€æœ‰ç›¸åŒçš„éƒ½ä¼šæ¶ˆå¤±ï¼Œç•™ä¸‹æ¥çš„å°±æ˜¯5äº†ã€‚<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">intsingleNumber(<span class="keyword">int</span> A[], <span class="keyword">int</span> n)</span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i)</span><br><span class="line">    &#123;  </span><br><span class="line">        A[<span class="number">0</span>] ^= A[i];  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> A[<span class="number">0</span>];  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿˜æœ‰å°±æ˜¯ç”¨ä¸tmpå€¼æ¥äº¤æ¢ä¸¤ä¸ªæ•°<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸ç”¨tempäº¤æ¢ä¸¤ä¸ªæ•´æ•°</span></span><br><span class="line">voidswap(<span class="keyword">int</span>&amp; x , <span class="keyword">int</span>&amp; y)</span><br><span class="line">&#123;</span><br><span class="line">    x ^= y;</span><br><span class="line">    y ^= x;</span><br><span class="line">    x ^= y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="6"><a href="#6" class="headerlink" title="6.~"></a>6.~</h1><p>è¿™ä¸ªåœ¨åŠ æ³•ä¸­ç”¨åˆ°</p><p>x-y = x + ~y + 1</p><p>æ‰€ä»¥~y = - y  -1</p><p>æ¯”å¦‚ ~11 = -11 -1 = -12</p><h1 id="7-å¿«é€Ÿå–æ¨¡"><a href="#7-å¿«é€Ÿå–æ¨¡" class="headerlink" title="7.%(å¿«é€Ÿå–æ¨¡)"></a>7.%(å¿«é€Ÿå–æ¨¡)</h1><p>æ±‚ 100 % 8çš„ ä¼˜åŒ–è§£æ³•ã€‚</p><p>æˆ‘ä»¬çŸ¥é“8åˆšå¥½æ˜¯2çš„3æ¬¡æ–¹ï¼Œ</p><p>æ‰€ä»¥ 100 % 8 == 100 - math.floor(100 / 8) * 8 == 100 -  ((100 &gt;&gt; 3) &lt;&lt; 3)ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¨¡ç‰ˆ </tag>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Algorithm&amp;Template</title>
      <link href="/posts/63125/"/>
      <url>/posts/63125/</url>
      
        <content type="html"><![CDATA[<ul><li><a href="/2018/07/24/æœ€å°ç”Ÿæˆæ ‘/">æœ€å°ç”Ÿæˆæ ‘</a></li><li><a href="/2018/07/26/Segment-Tree-PART-ONE/">æ™®é€šçº¿æ®µæ ‘</a></li><li><a href="/2018/07/27/Segment-Tree-ZKW-PART-TWO/">zkwçº¿æ®µæ ‘</a></li><li><a href="/2018/07/29/è«é˜Ÿ/">è«é˜Ÿ</a></li><li><a href="/404">KMPå­—ç¬¦ä¸²åŒ¹é…</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> å½’æ¡£ </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
